<!DOCTYPE html>
<!-- saved from url=(0081)file:///C:/Users/64403/AppData/Local/Temp/crossnote202529-16416-1ngp2yd.ab0r.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Kyber 和 Aigis-enc的不同之处</title>
      
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="./Kyber 和 Aigis-enc的不同之处_files/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="kyber-和-aigis-enc的不同之处">Kyber 和 Aigis-enc的不同之处 </h1>
<h2 id="0-参数集的不同">0 参数集的不同 </h2>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/image-3.png" alt="alt text"><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/image-2.png" alt="alt text"></p>
<h2 id="1-parse--b---rq均匀随机采样rq中的多项式">1 Parse : B ∗ → Rq均匀随机采样Rq中的多项式 </h2>
<p>Parse  是将字节流解析成多项式表示的方法。</p>
<h3 id="11-字节组合方式">1.1 字节组合方式 </h3>
<ul>
<li>
<p><strong>Angis-enc</strong>:</p>
<ul>
<li>每次从字节流中取两个字节 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">b_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><mn>256</mn><mo>×</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">d = b_i + 256 \times b_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">256</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li>然后，结果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> 会被对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 取模并进行约简，最终如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">d &lt; q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>，则该值赋给多项式的系数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>a</mi><mo>^</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{a}_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
<li>
<p><strong>Kyber</strong>:</p>
<ul>
<li>同样每次取字节流中的三个字节 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">b_i, b_{i+1}, b_{i+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，进行更加复杂的处理。</li>
<li>其中，计算分为两部分：
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><mn>256</mn><mo>×</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mspace></mspace><mspace width="0.6667em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>16</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_1 = b_i + 256 \times (b_{i+1} \mod 16)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">256</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">16</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">⌊</mo><mfrac><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mn>16</mn></mfrac><mo stretchy="false">⌋</mo><mo>+</mo><mn>16</mn><mo>×</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">d_2 = \lfloor \frac{b_{i+1}}{16} \rfloor + 16 \times b_{i+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2829em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9379em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4518em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li>
</ol>
</li>
<li>每个部分都进行对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的取模，并且分别判断是否满足条件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">d_1 &lt; q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>&lt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">d_2 &lt; q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>，若满足则赋值给多项式的系数。</li>
</ul>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>``<span class="token constant">`verilog</span>
<span class="token keyword keyword-assign">assign</span> d1 <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">4'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_0 <span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">8'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_1<span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//-- d1 = b[i] + 256(b[i+1] mod + 16)</span>
<span class="token keyword keyword-assign">assign</span> d2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">4'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_1<span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">4'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_2<span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//-- d2 = b[i+1]/16 + b[i+2]*16</span>

``<span class="token constant">`verilog</span>

对应 a_in变量的计算过程需要修改
其中A_generator中对应逻辑需要修改<span class="token number">60</span>和<span class="token number">61</span>行
<span class="token keyword keyword-assign">assign</span> d1 <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_0 <span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">8'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>i_1<span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//-- d1 = b[i] + 256(b[i+1] )</span>
<span class="token keyword keyword-assign">assign</span> d2 <span class="token operator">=</span> d1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//-- d2 = d1 mod+2^13</span>
</code></pre></li>
</ul>
<h3 id="12-循环步长和字节流解析">1.2 循环步长和字节流解析 </h3>
<ul>
<li><strong>Angis-enc</strong>: 字节流每次增加 2 个字节（i 增加 2），也就是说每两字节构成一个系数,也就是13位构成一个系数。</li>
<li><strong>Kyber</strong>: 字节流每次增加 3 个字节（i 增加 3），也就是三个字节构成两个系数，12位构成一个系数。<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>``<span class="token constant">`verilog</span>
对应 <span class="token keyword keyword-assign">assign</span> i_0 变量的计算过程需要修改
其中A_generator中对应逻辑需要修改<span class="token number">51</span>行
<span class="token keyword keyword-assign">assign</span> i_0 <span class="token operator">=</span> icnt <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>                                            <span class="token comment">//-- i_0  = icnt*8           0,24,48,72,...,744</span>
 <span class="token keyword keyword-assign">assign</span> i_1 <span class="token operator">=</span> <span class="token punctuation">(</span>icnt <span class="token operator">+</span> <span class="token number">12'd1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>                                  <span class="token comment">//-- i_1  = (icnt+1)*8       8,32,56,80,...,752</span>
 <span class="token keyword keyword-assign">assign</span> i_2 <span class="token operator">=</span> <span class="token punctuation">(</span>icnt <span class="token operator">+</span> <span class="token number">12'd2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>  
其中不需要i_2了
因此原因，其对应的<span class="token number">142</span><span class="token operator">-</span><span class="token number">155</span>的逻辑也需要修改
<span class="token function">case</span><span class="token punctuation">(</span><span class="token operator">{</span>d1_valid<span class="token punctuation">,</span>d2_valid<span class="token operator">}</span><span class="token punctuation">)</span>
<span class="token number">2'b11</span><span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  dout_pre     <span class="token operator">=</span> <span class="token punctuation">(</span>dout_pre <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>d1 <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> d2<span class="token punctuation">;</span>
  dout_pre_num <span class="token operator">=</span> dout_pre_num <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
将<span class="token number">12</span>改成<span class="token number">13</span>，<span class="token number">24</span>改成<span class="token number">26</span>
kyber情况所需要的i1数量必需大于<span class="token number">256</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">=</span><span class="token number">384</span>，但是其中生成的d1<span class="token operator">/</span>d2有可能会大于<span class="token number">3329</span>，会有概率有些不有效，<span class="token number">384</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">3329</span><span class="token operator">/</span><span class="token number">4096</span><span class="token punctuation">)</span> ≈<span class="token number">3780</span><span class="token punctuation">,</span>如下面的图片可知，shake<span class="token operator">-</span><span class="token number">128</span>一次生成 <span class="token number">1344</span>，则取整后<span class="token number">1344</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">=</span><span class="token number">4032</span><span class="token operator">&gt;</span><span class="token number">3780</span>，所以i1<span class="token operator">=</span><span class="token number">4032</span><span class="token operator">/</span><span class="token number">8</span><span class="token operator">=</span><span class="token number">504</span>

而aigis<span class="token operator">-</span>enc中i1数量必须大于<span class="token number">256</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">=</span><span class="token number">512</span>，但是其中生成的d1<span class="token operator">/</span>d2有可能会大于<span class="token number">7681</span>，会有概率有些不有效，所以<span class="token number">512</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">/</span>（<span class="token number">7681</span><span class="token operator">/</span><span class="token number">8192</span>）≈<span class="token number">4369</span>，取整后<span class="token number">1344</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">=</span><span class="token number">5376</span><span class="token operator">&gt;</span><span class="token number">4369</span><span class="token punctuation">,</span>则此处i1<span class="token operator">=</span><span class="token number">4369</span><span class="token operator">/</span><span class="token number">8</span><span class="token operator">=</span><span class="token number">672</span>
所以a_in也需要增加，以及b<span class="token punctuation">,</span>c的位数，对应源代码如下，和SHAKE_128<span class="token punctuation">.</span>v文件的输出也要修改。
第 <span class="token number">7</span> 行 <span class="token keyword keyword-input">input</span> <span class="token punctuation">[</span><span class="token number">4031</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    a_in
第<span class="token number">38</span><span class="token operator">~</span><span class="token number">43</span>行
<span class="token keyword keyword-genvar">genvar</span> i1<span class="token punctuation">;</span>
<span class="token keyword keyword-generate">generate</span>
    <span class="token function">for</span><span class="token punctuation">(</span>i1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i1<span class="token operator">&lt;</span><span class="token number">504</span><span class="token punctuation">;</span> i1<span class="token operator">=</span>i1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
        <span class="token keyword keyword-assign">assign</span> b<span class="token punctuation">[</span><span class="token number">4031</span><span class="token operator">-</span>i1<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">4024</span><span class="token operator">-</span>i1<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">[</span>i1<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">:</span>i1<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-endgenerate">endgenerate</span>

</code></pre></li>
</ul>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/shake.png" alt="alt text"></p>
<h2 id="2-cbdη---bnη4--rq-二项分布采样">2 CBDη : <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mi>n</mi><mi>η</mi><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{nη/4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="mord mtight">/4</span></span></span></span></span></span></span></span></span></span></span></span>→ Rq 二项分布采样 </h2>
<p>算法逻辑一模一样<br>
但是其中的η的参数取值不一样，并且对于这两个算法来说，如果在aigis-enc中使用地方不一样，参数取值不一样。根据需要的比特来决定。<br>
<strong>代码修改点</strong><br>
为了适配 <code>ram_wdata</code> 从 <code>8*12</code> 变为 <code>8*13</code>，并将 <code>12'd3329</code> 变为 <code>13'd7681</code>，将<code>η</code>从<code>2或者3</code>修改为<code>8或者4或者2</code>主要涉及以下修改：</p>
<h3 id="1-修改-ram_wdata-的位宽"><strong>1. 修改 <code>ram_wdata</code> 的位宽</strong> </h3>
<p><code>ram_wdata</code> 原本是 <code>96</code> 位（<code>8 * 12</code>），现在要改为 <code>104</code> 位（<code>8 * 13</code>）。</p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-output">output</span> <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ram_wdata<span class="token punctuation">,</span>  <span class="token comment">// 修改位宽从 96 改为 104</span>
</code></pre><h3 id="2-修改溢出处理的模数"><strong>2. 修改溢出处理的模数</strong> </h3>
<p>代码中 <code>3329</code> 需要替换为 <code>7681</code>：</p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>ram_wdata<span class="token punctuation">[</span><span class="token number">00</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp1 <span class="token operator">&lt;</span> b_temp1<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp1 <span class="token operator">-</span> b_temp1<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp1 <span class="token operator">-</span> b_temp1<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">13</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp2 <span class="token operator">&lt;</span> b_temp2<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp2 <span class="token operator">-</span> b_temp2<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp2 <span class="token operator">-</span> b_temp2<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">26</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp5 <span class="token operator">&lt;</span> b_temp5<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp5 <span class="token operator">-</span> b_temp5<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp5 <span class="token operator">-</span> b_temp5<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">39</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp6 <span class="token operator">&lt;</span> b_temp6<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp6 <span class="token operator">-</span> b_temp6<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp6 <span class="token operator">-</span> b_temp6<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">52</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp3 <span class="token operator">&lt;</span> b_temp3<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp3 <span class="token operator">-</span> b_temp3<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp3 <span class="token operator">-</span> b_temp3<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">65</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp4 <span class="token operator">&lt;</span> b_temp4<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp4 <span class="token operator">-</span> b_temp4<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp4 <span class="token operator">-</span> b_temp4<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">78</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp7 <span class="token operator">&lt;</span> b_temp7<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp7 <span class="token operator">-</span> b_temp7<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp7 <span class="token operator">-</span> b_temp7<span class="token punctuation">)</span><span class="token punctuation">;</span>
ram_wdata<span class="token punctuation">[</span><span class="token number">91</span><span class="token operator">+</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a_temp8 <span class="token operator">&lt;</span> b_temp8<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token number">13'd7681</span> <span class="token operator">+</span> a_temp8 <span class="token operator">-</span> b_temp8<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>a_temp8 <span class="token operator">-</span> b_temp8<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>这里将 <code>12-bit</code> 计算改为 <code>13-bit</code> 计算。</li>
<li><code>+:12</code> 改为 <code>+:13</code> 以匹配新的数据宽度。</li>
</ul>
<h3 id="3-修改-ram_wdata-的默认值"><strong>3. 修改 <code>ram_wdata</code> 的默认值</strong> </h3>
<p>在 <code>STATE0</code> 和 <code>STATE2</code> 复位时，<code>ram_wdata</code> 需要调整：</p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>ram_wdata <span class="token operator">=</span> <span class="token number">104'd0</span><span class="token punctuation">;</span>  <span class="token comment">// 96'd0 改为 104'd0</span>
</code></pre><h3 id="4-修改-a_temp-和-b_temp-的位宽"><strong>4. 修改 <code>a_temp</code> 和 <code>b_temp</code> 的位宽</strong> </h3>
<p>因为 <code>ram_wdata</code> 变为 <code>13-bit</code> 计算，<code>a_temp</code> 和 <code>b_temp</code> 需要从 <code>12-bit</code> 扩展到 <code>13-bit</code>：</p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> a_temp1<span class="token punctuation">,</span> b_temp1<span class="token punctuation">,</span> a_temp2<span class="token punctuation">,</span> b_temp2<span class="token punctuation">,</span> a_temp3<span class="token punctuation">,</span> b_temp3<span class="token punctuation">;</span>
<span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> a_temp4<span class="token punctuation">,</span> b_temp4<span class="token punctuation">,</span> a_temp5<span class="token punctuation">,</span> b_temp5<span class="token punctuation">,</span> a_temp6<span class="token punctuation">,</span> b_temp6<span class="token punctuation">;</span>
<span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> a_temp7<span class="token punctuation">,</span> b_temp7<span class="token punctuation">,</span> a_temp8<span class="token punctuation">,</span> b_temp8<span class="token punctuation">;</span>
</code></pre><ul>
<li>这里 <code>wire</code> 的位宽由 <code>12-bit</code> 扩展为 <code>13-bit</code>。</li>
</ul>
<h3 id="5-关于-cbd_num-的修改">5. <strong>关于 <code>cbd_num</code> 的修改</strong> </h3>
<p>原来 <code>cbd_num</code> 是一个 2 位的信号，用于区分不同的 <code>eta</code> 值。现在我们需要修改其功能，使得 <code>cbd_num</code> 能支持三个不同的 <code>eta</code> 值（分别为 <code>eta = 2</code>, <code>eta = 4</code>, 和 <code>eta = 8</code>），因此我们对其赋值和索引的计算方式进行了修改。</p>
<p><strong>修改前：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> index_a <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
                 <span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">;</span> 
<span class="token keyword keyword-assign">assign</span> index_b <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">11'd3</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">3'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">11'd2</span><span class="token punctuation">;</span>
</code></pre><p><strong>修改后：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> index_a <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>  <span class="token comment">// eta=2时：2*i*n1=2*i*2</span>
                 <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>  <span class="token comment">// eta=4时：2*i*n2=2*i*4</span>
                 <span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>                       <span class="token comment">// eta=8时：2*i*n3=2*i*8</span>
<span class="token keyword keyword-assign">assign</span> index_b <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15'd2</span><span class="token punctuation">:</span>  <span class="token comment">// eta=2时：2*i*n1=2*i*2+2</span>
                 <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15'd4</span><span class="token punctuation">:</span>  <span class="token comment">// eta=4时：2*i*n2=2*i*4+4</span>
                 <span class="token punctuation">(</span><span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> counter_i<span class="token operator">}</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">15'd8</span><span class="token punctuation">;</span>                       <span class="token comment">// eta=8时：2*i*n3=2*i*8+8</span>
</code></pre><p>解释：</p>
<ul>
<li><strong><code>cbd_num == 2'd0</code></strong> 对应 <code>eta = 2</code>，此时索引计算为 <code>2*i*2</code>。</li>
<li><strong><code>cbd_num == 2'd1</code></strong> 对应 <code>eta = 4</code>，此时索引计算为 <code>2*i*4</code>。</li>
<li><strong><code>cbd_num == 2'd2</code></strong> 对应 <code>eta = 8</code>，此时索引计算为 <code>2*i*8</code>。</li>
<li><code>index_a</code>为12位信号，<code>counter_i</code>为10位信号，则<code>3'd0</code>,修改为<code>5'd0</code>，防止溢出</li>
</ul>
<h3 id="6-关于-cbd_in-输入比特流宽度的修改">6. <strong>关于 <code>cbd_in</code> 输入比特流宽度的修改</strong> </h3>
<p>原先，<code>cbd_in</code> 的宽度为 1536 位（即 <code>  256 * 3 / 4 * 8 = 1536</code>），但由于输入比特流的长度需要满足可以被 8 整除的要求，同时考虑到 <code>eta = 8</code> 的情况，我们将其扩展为 4096 位。</p>
<p><strong>修改前：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-input">input</span> <span class="token punctuation">[</span><span class="token number">1536</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> cbd_in<span class="token punctuation">;</span>  <span class="token comment">// 输入比特流（用于CBD采样）</span>
</code></pre><p><strong>修改后：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-input">input</span> <span class="token punctuation">[</span><span class="token number">4096</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> cbd_in<span class="token punctuation">;</span>  <span class="token comment">// 输入比特流（用于CBD采样）</span>
</code></pre><p>解释：</p>
<ul>
<li>根据新的要求，满足最大 <code>eta</code> 为 8 的情况。计算得出 <code>256 * 8 / 4 * 8 = 4087</code>，因此将输入数据长度扩展为 4096 位。</li>
</ul>
<h3 id="7-关于-b_data-的重排修改">7. <strong>关于 <code>b_data</code> 的重排修改</strong> </h3>
<p>由于输入比特流长度的变化，<code>b_data</code> 的生成需要相应地调整。原本的 <code>b_data</code> 生成使用了 <code>i</code> 的最大值为 192（<code>1536 / 8 = 192</code>），现在需要将 <code>i</code> 的最大值修改为 511（<code>4096 / 8 = 512</code>），同时调整 <code>b_data</code> 的生成方式。</p>
<p><strong>修改前：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-generate">generate</span>
   <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">192</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span><span class="token punctuation">:</span> gen_b_str
      <span class="token keyword keyword-assign">assign</span> b_data<span class="token punctuation">[</span><span class="token number">1535</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">8</span> <span class="token punctuation">:</span> <span class="token number">1528</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> cbd_in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">7</span> <span class="token punctuation">:</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-endgenerate">endgenerate</span>
</code></pre><p><strong>修改后：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-generate">generate</span>
   <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">512</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span><span class="token punctuation">:</span> gen_b_str
      <span class="token keyword keyword-assign">assign</span> b_data<span class="token punctuation">[</span><span class="token number">4095</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">8</span> <span class="token punctuation">:</span> <span class="token number">4087</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> cbd_in<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">7</span> <span class="token punctuation">:</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-endgenerate">endgenerate</span>
</code></pre><p>解释：</p>
<ul>
<li>修改后的 <code>b_data</code> 会处理新的输入数据长度 <code>4096</code> 位，<code>i</code> 的范围调整为 <code>0</code> 到 <code>511</code>（共 512 个数据块）。每个数据块的大小为 8 位，并依次从 <code>cbd_in</code> 中提取。</li>
</ul>
<h3 id="8-关于-b_2-和-b_3-的修改">8. <strong>关于 <code>b_2</code> 和 <code>b_3</code> 的修改</strong> </h3>
<p>根据 <code>eta</code> 的不同值，我们需要调整 <code>b_2</code> 和 <code>b_3</code> 的赋值。对于不同的 <code>eta</code>，<code>b_2</code> 和 <code>b_3</code> 会从 <code>b_data</code> 中提取不同的部分。</p>
<p><code>eta = 8</code>（<code>cbd_num == 2'd2</code>）时，<code>b_data</code> 的大小为 <code>4095:0</code>。</p>
<p><code>eta = 4</code>（<code>cbd_num == 2'd1</code>）时，<code>b_2</code> 的大小为 <code>4095:2048</code>。</p>
<p><code>eta = 2</code>（<code>cbd_num == 2'd0</code>）时，<code>b_3</code> 的大小为 <code>4095:3072</code>，并新增 <code>b_3</code>。</p>
<p><strong>修改前：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> b_2 <span class="token operator">=</span> b_data<span class="token punctuation">[</span><span class="token number">1535</span><span class="token punctuation">:</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><p><strong>修改后：</strong></p>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> b_2 <span class="token operator">=</span>  b_data<span class="token punctuation">[</span><span class="token number">4095</span><span class="token punctuation">:</span><span class="token number">2048</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>  <span class="token comment">// eta=4时：b_data[4095:2048]</span>
<span class="token keyword keyword-assign">assign</span> b_3 <span class="token operator">=</span> b_data<span class="token punctuation">[</span><span class="token number">4095</span><span class="token punctuation">:</span><span class="token number">3072</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>  <span class="token comment">// eta=2时：b_data[4095:3072]</span>
</code></pre><p>解释：原本只有两个eta值，现在有3个，所以需要增加以一个<code>b_3</code><br>
因为<code>eta=4</code>时，<code>2*256*4=2048</code>，<br>
则将原本的<code>assign b_2 = b_data[1535:512]</code>; 修改为<code>assign b_2 = b_data[4095:2048]</code>;（因为4095-2048=2047）<br>
因为<code>eta=2</code>时，<code>2*256*2=1024</code>，<br>
所以再加一个<code>assign b_3 = b_data[4095:3072]</code>（因为<code>4095-3072=1023</code>）</p>
<h3 id="9-a_temp1-计算公式的修改">9. <strong><code>a_temp1</code> 计算公式的修改</strong> </h3>
<p>你要求修改 <code>a_temp1</code> 的计算公式，使得当 <code>cbd_num</code> 为不同值时，进行不同的加法操作。并且 <code>11</code> 位改为 <code>12</code> 位，修改后的代码逻辑如下：</p>
<h4 id="原代码">原代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> a_temp1 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd1</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd2</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                                      <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
<span class="token keyword keyword-assign">assign</span> b_temp1 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd1</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd2</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span><span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改后的代码">修改后的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token keyword keyword-assign">assign</span> a_temp1 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>  <span class="token comment">// cbd_num == 00: 使用 b_3 数据</span>
                 <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> 
                                      <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>  <span class="token comment">// cbd_num == 01: 使用 b_2数据</span>
                 <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> 
                 <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd4</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd5</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> 
                 <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd6</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>  <span class="token comment">// cbd_num == 11: 使用 b_data 数据，8项加法</span>
</code></pre><h4 id="修改解释">修改解释： </h4>
<ul>
<li><strong><code>cbd_num == 00</code></strong> 时，使用 <code>b_3[index_a]</code> 和 <code>b_3[index_a+1]</code> 来计算 <code>a_temp1</code>。</li>
<li><strong><code>cbd_num == 01</code></strong> 时，使用 <code>b_2</code> 来计算 <code>a_temp1</code></li>
<li><strong><code>cbd_num == 11</code></strong> 时，使用 <code>b_data[index_a]</code> 到 <code>b_data[index_a+7]</code>，共进行 8 项加法。</li>
</ul>
<h3 id="10-i-变化时-index-调整的修改">10. <strong><code>i</code> 变化时 <code>index</code> 调整的修改</strong> </h3>
<h4 id="原逻辑">原逻辑： </h4>
<ul>
<li>当 <code>i=0</code> 时，<code>f0,index+</code>，<code>f1,index+</code></li>
<li>当 <code>i=1</code> 时，<code>f1,index+6*1</code>，<code>f1,index+4*1</code></li>
<li>当 <code>i=64</code> 时，<code>f64,index+6*64</code>，<code>f64,index+4*64</code></li>
<li>当 <code>i=65</code> 时：<code>f65,index+6*65；f65,index+4*65</code></li>
<li>当 <code>i=128</code> 时： <code>f128,index+6*128；f128,index+4*128</code></li>
<li>当 <code>i=129</code> 时： <code>f129,index+6*129；f129,index+4*129</code></li>
<li>当 <code>i=192</code> 时：<code>f192,index+6*192；f192,index+4*192</code></li>
<li>当 <code>i=193</code> 时： <code>f193,index+6*193；f193,index+4*193</code></li>
</ul>
<h4 id="修改后逻辑">修改后逻辑： </h4>
<p>每行对应一个 <code>i</code>，后面跟着按 <code>6*i</code> 和 <code>4*i</code> 计算的 <code>index</code>。</p>
<ul>
<li>当 <code>i=0</code> 时，<code>f0,index</code>，<code>f0,index</code>，<code>f0,index</code></li>
<li>当 <code>i=1</code> 时，<code>f1,index+4*1</code>，<code>f1,index+8*1</code>，<code>index+16*1</code></li>
<li>当 <code>i=64</code> 时，<code>f64,index+4*64→256</code>，<code>f64,index+8*64→512</code>，<code>index+16*64→1024</code></li>
<li>当 <code>i=65</code> 时： <code>f65,index+4*65→260，f65,index+8*65→520，f65,index+16*65→1040</code></li>
<li>当 <code>i=128</code> 时： <code>f128,index+4*128→512，f128,index+8*128→1024，f128,index+16*128→2048</code></li>
<li>当 <code>i=129</code> 时：<code>f129,index+4*129→516，f129,index+8*129→1032，f129,index+16*129→2064</code></li>
<li>当 <code>i=192</code> 时： <code>f192,index+4*192→768，f192,index+8*192→1536，f192,index+16*192→3072</code></li>
<li>当 <code>i=193</code> 时：<code>f193,index+4*193→772，f193,index+8*193→1544，f193,index+16*193→3088</code></li>
</ul>
<h4 id="原来的代码">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  <span class="token comment">//-- when i=1 =&gt; f1,index+6*1;  f1,index+4*1</span>
  <span class="token keyword keyword-assign">assign</span> a_temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd6</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd7</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                                      <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd4</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">11'd5</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-assign">assign</span> b_temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd6</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd7</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                                      <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd4</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">11'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">11'd5</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>


</code></pre><h4 id="修改后的代码-1">修改后的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  

<span class="token comment">// a_temp2 and b_temp2 for i = 1//-- when i=1 =&gt; `f0,index+4*1`，`f1,index+8*1`，`index+16*1`</span>
<span class="token comment">// a_temp2 and b_temp2 for i = 1</span>
<span class="token keyword keyword-assign">assign</span> a_temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd4</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd5</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd9</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd10</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd11</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd16</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd17</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd18</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd19</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd20</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd21</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd22</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd23</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd4</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd5</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd8</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd9</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd10</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd11</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd16</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd17</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd18</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd19</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd20</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd21</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd22</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd23</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token comment">// a_temp3 and b_temp3 for i = 64//- 当 `i=64` 时，`f64,index+4*64→256`，`f64,index+8*64→512`，`index+16*64→1024`</span>
<span class="token keyword keyword-assign">assign</span> a_temp3 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd256</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd257</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd512</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd513</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd514</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd515</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1024</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1025</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1026</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1027</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1028</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1029</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1030</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1031</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp3 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd256</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd257</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd512</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd513</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd514</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd515</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1024</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1025</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1026</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1027</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1028</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1029</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1030</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1031</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
<span class="token comment">//当 `i=65` 时： `f65,index+4*65→260，f65,index+8*65→520，f65,index+16*65→1040`</span>
<span class="token keyword keyword-assign">assign</span> a_temp4 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd260</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd261</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd520</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd521</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd522</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd523</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1040</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1041</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1042</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1043</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1044</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1045</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1046</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1047</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp4 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd260</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd261</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd520</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd521</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd522</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd523</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1040</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1041</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1042</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1043</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1044</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1045</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1046</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1047</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
<span class="token comment">//当 `i=128` 时： `f128,index+4*128→512，f128,index+8*128→1024，f128,index+16*128→2048`</span>
<span class="token keyword keyword-assign">assign</span> a_temp5 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd512</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd513</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1024</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1025</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1026</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1027</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2048</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2049</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2050</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2051</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2052</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2053</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2054</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2055</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp5 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd512</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd513</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1024</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1025</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1026</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1027</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2048</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2049</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2050</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2051</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2052</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2053</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2054</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2055</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
<span class="token comment">//当 `i=129` 时：`f129,index+4*129→516，f129,index+8*129→1032，f129,index+16*129→2064` </span>
<span class="token keyword keyword-assign">assign</span> a_temp6 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd516</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd517</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1032</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1033</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1034</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1035</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2064</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2065</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2066</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2067</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2068</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2069</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2070</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd2071</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp6 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd516</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd517</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1032</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1033</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1034</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1035</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2064</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2065</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2066</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2067</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2068</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2069</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2070</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd2071</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token comment">//当 `i=192` 时： `f192,index+4*192→768，f192,index+8*192→1536，f192,index+16*192→3072`</span>
<span class="token keyword keyword-assign">assign</span> a_temp6 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd768</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd769</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1536</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1537</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1538</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1539</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3072</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3073</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3074</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3075</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3076</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3077</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3078</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3079</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp6 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd768</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd769</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1536</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1537</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1538</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1539</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3072</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3073</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3074</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3075</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3076</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3077</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3078</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3079</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
<span class="token comment">//当 `i=193` 时：`f193,index+4*193→772，f193,index+8*193→1544，f193,index+16*193→3088`</span>
<span class="token keyword keyword-assign">assign</span> a_temp8 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd772</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd773</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1544</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1545</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1546</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd1547</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3088</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3089</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3090</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3091</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3092</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3093</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3094</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_a<span class="token operator">+</span><span class="token number">12'd3095</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-assign">assign</span> b_temp8 <span class="token operator">=</span> <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd772</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_3<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd773</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token punctuation">(</span>cbd_num <span class="token operator">==</span> <span class="token number">2'd1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1544</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1545</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1546</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_2<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd1547</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3088</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3089</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3090</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3091</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token punctuation">:</span>
                <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3092</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3093</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3094</span><span class="token punctuation">]</span><span class="token operator">}</span> <span class="token operator">+</span> <span class="token operator">{</span><span class="token number">12'd0</span><span class="token punctuation">,</span> b_data<span class="token punctuation">[</span>index_b<span class="token operator">+</span><span class="token number">12'd3095</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改解释-1">修改解释： </h4>
<ul>
<li>当 <code>i=1</code> 时，<code>index</code> 依次增加 <code>4*1</code>、<code>8*1</code> 和 <code>16*1</code>。</li>
<li>当 <code>i=64</code> 时，<code>index</code> 依次增加 <code>4*64</code>、<code>8*64</code> 和 <code>16*64</code>。<br>
这段代码的核心是通过计算 <code>index</code> 的不同<code>eta</code>（4、8、16）来满足不同的需求。</li>
</ul>
<h2 id="3-decode_l-bnl8--r_q--编码与解码">3 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><msub><mi>e</mi><mi mathvariant="normal">ℓ</mi></msub><mo>:</mo><msup><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>→</mo><msub><mi>R</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">Decode_ℓ: B^{nℓ/8} → R_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">ℓ</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 编码与解码 </h2>
<p>算法逻辑一模一样<br>
只有其中的l的参数取值不一样，A并且对于这两个算法来说，如果在aigis-enc中使用地方不一样，参数取值不一样。根据需要的比特来决定。对应<code>coder.v</code>文件</p>
<h3 id="1-位数修改">1. 位数修改 </h3>
<ol>
<li>所有 [6399:0]改成 [5375:0]  因为公钥输入，大小为 12<em>256</em>2 + 256 变成 dt·k·n+n = 10<em>2</em>256+256=5376</li>
<li>所有 [13055:0]改成 [12543:0]  因为私钥输入，大小为 12<em>256</em>2 变成13<em>k</em>n=13<em>2</em>256=6656//(13+10)<em>2</em>256+3*256=12544</li>
<li>input [6143:0] c_in 改成 [5375:0] 因为密文输入，大小为 10<em>256</em>2 + 4*256 变成 9⋅2⋅256+3⋅256=5376</li>
<li>output [6143:0] sk_out<br>
//-- store s at Key_gen, store  m  at Enc, store s/m at Dec<br>
reg  [6143:0]       s_m_reg;<br>
reg  [6143:0]       m_reg;<br>
改成 [6655:0] 因为 12<em>256</em>2 变成13 * 2*256=6656</li>
<li>output [6143:0] code_out 改成[5375:0] 因为密文输出，大小为 10 * 256 * 2 + 4 * 256 变成 9⋅2⋅256+3⋅256=5376</li>
<li>所有 [95:0] 变成 [103:0] 因为从12 * 8变成13 * 8</li>
<li>reg  [6143:0]       t_c_reg;// 存储 t（密钥生成时）或 t/c（加密时）或 c（解密时）<br>
此处或许需要再加两个，<br>
因为当t（密钥生成时），因为从96 * 64变成 80<em>64=5120，位数为[5119:0]；<br>
当t/c（加密时），位数从80 * 64+32 * 32变成  72 * 64+24 * 32=5376，位数为[5375:0]<br>
当 c（解密时），位数从96</em>64变成104*64=6656，位数为[6655:0]</li>
<li>reg  [5119:0]       decode_u_reg;需要从 80 * 64变成  72 * 64 = 4608，即[4607:0]<br>
reg  [1023:0]       decode_v_reg;需要从 32 * 32变成  24 * 32 = 768，即[765:0]</li>
</ol>
<h3 id="位数修改">位数修改 </h3>
<ol>
<li>所有 <code>[6399:0]</code> 改成 <code>[5375:0]</code>
<ul>
<li>原因：公钥输入，大小由 <code>12*256*2 + 256</code> 变为 <code>dt·k·n+n = 10*2*256+256=5376</code></li>
</ul>
</li>
<li>所有 <code>[13055:0]</code> 改成 <code>[12543:0]</code>
<ul>
<li>原因：私钥输入，大小由 <code>12*256*2</code> 变为 <code>13*k*n=13*2*256=6656</code>，计算方式为 <code>(13+10)*2*256+3*256=12544</code></li>
</ul>
</li>
<li><code>input [6143:0] c_in</code> 改成 <code>[5375:0]</code>
<ul>
<li>原因：密文输入，大小由 <code>10*256*2 + 4*256</code> 变为 <code>9⋅2⋅256+3⋅256=5376</code></li>
</ul>
</li>
<li>输出 <code>sk_out</code> 修改</li>
</ol>
<ul>
<li><strong>修改内容</strong>：
<ul>
<li><code>output [6143:0] sk_out</code> <strong>改为</strong> <code>output [6655:0] sk_out</code></li>
</ul>
</li>
<li><strong>修改原因</strong>：
<ul>
<li>存储 <code>s</code>（密钥生成时）、<code>m</code>（加密时）或 <code>s/m</code>（解密时）的位数由 <code>12 * 256 * 2</code> 变更为 <code>13 * 2 * 256 = 6656</code></li>
<li>代码调整：<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- store s at Key_gen, store m at Enc, store s/m at Dec</span>
<span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">6655</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> s_m_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">6655</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> m_reg<span class="token punctuation">;</span>
</code></pre></li>
</ul>
</li>
</ul>
<ol start="5">
<li>
<p>输出 <code>code_out</code> 修改</p>
<ul>
<li><strong>修改内容</strong>：
<ul>
<li><code>output [6143:0] code_out</code> <strong>改为</strong> <code>output [5375:0] code_out</code></li>
</ul>
</li>
<li><strong>修改原因</strong>：
<ul>
<li>密文输出的大小由 <code>10 * 256 * 2 + 4 * 256</code> 变更为 <code>9 * 2 * 256 + 3 * 256 = 5376</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>所有 <code>[95:0]</code> 修改为 <code>[103:0]</code></p>
<ul>
<li><strong>修改原因</strong>：
<ul>
<li>位数由 <code>12 * 8 = 96</code> 变更为 <code>13 * 8 = 104</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>t_c_reg</code> 修改</p>
<ul>
<li><strong>根据 <code>t</code>、<code>t/c</code> 或 <code>c</code> 的不同用途，位数需要相应调整</strong>：
<ul>
<li><strong>密钥生成 (<code>t</code>)</strong>：
<ul>
<li>位数由 <code>96 * 64</code> 变更为 <code>80 * 64 = 5120</code></li>
<li><code>reg [5119:0] t_c_reg;</code></li>
</ul>
</li>
<li><strong>加密 (<code>t/c</code>)</strong>：
<ul>
<li>位数由 <code>80 * 64 + 32 * 32</code> 变更为 <code>72 * 64 + 24 * 32 = 5376</code></li>
<li><code>reg [5375:0] t_c_reg;</code></li>
</ul>
</li>
<li><strong>解密 (<code>c</code>)</strong>：
<ul>
<li>位数由 <code>96 * 64</code> 变更为 <code>104 * 64 = 6656</code></li>
<li><code>reg [6655:0] t_c_reg;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>decode_u_reg</code> 和 <code>decode_v_reg</code> 修改</p>
<ul>
<li><strong><code>decode_u_reg</code></strong>：
<ul>
<li><code>reg [5119:0] decode_u_reg;</code></li>
<li><strong>修改为</strong> <code>reg [4607:0] decode_u_reg;</code></li>
<li>位数由 <code>80 * 64 = 5120</code> 变更为 <code>72 * 64 = 4608</code></li>
</ul>
</li>
<li><strong><code>decode_v_reg</code></strong>：
<ul>
<li><code>reg [1023:0] decode_v_reg;</code></li>
<li><strong>修改为</strong> <code>reg [765:0] decode_v_reg;</code></li>
<li>位数由 <code>32 * 32 = 1024</code> 变更为 <code>24 * 32 = 768</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="原来的代码-1">原来的代码 </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token comment">//-- register wires</span>
   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_t_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_t    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_u_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_u    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_v_in <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_v    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token comment">//-- The data read from the RAM is placed here</span>
   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         s_m_reg_s_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         s_m_reg_s    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>          m_reg_in     <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>          s_m_reg_m    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码">修改的代码 </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token comment">//-- register wires</span>
   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_t_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_t    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_u_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_u    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_v_in <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         t_c_reg_v    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token comment">//-- The data read from the RAM is placed here</span>
   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         s_m_reg_s_in <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>         s_m_reg_s    <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

   <span class="token keyword keyword-reg">reg</span>  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>          m_reg_in     <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>          s_m_reg_m    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><p>相应的，后续代码中位数对应修改即可，这里的修改原因，可以见后面参数修改部分</p>
<h3 id="2算法4中-keygen_encode_sk参数修改">2.算法4中 KeyGen_Encode_sk参数修改 </h3>
<h4 id="原来的代码-2">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_sk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token comment">//-- 512 coefficients require 64 addresses</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    s_m_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">96</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">:</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">:</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">:</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h4 id="推理过程">推理过程： </h4>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></mrow><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><mn>12</mn></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mover accent="true"><mi>s</mi><mo>^</mo></mover><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><msup><mtext> </mtext><mo>+</mo></msup><mi>q</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{sk} := \text{Encode}_{12}\bigl(\hat{s} \bmod^+ q \bigr)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathbf">sk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mspace" style="margin-right:0.0556em;"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose"><span class="delimsizing size1">)</span></span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></mrow><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo></mrow></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mover accent="true"><mi>s</mi><mo>^</mo></mover><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><msup><mtext> </mtext><mo>+</mo></msup><mi>q</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{sk} := \text{Encode}_{\lceil \log_2 q \rceil}\bigl(\hat{s} \bmod^+ q \bigr)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathbf">sk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2163em;vertical-align:-0.3663em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3663em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mspace" style="margin-right:0.0556em;"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose"><span class="delimsizing size1">)</span></span></span></span></span></span><br>
也就是说，原本是从12字节变成8字节<br>
现在aigis需要从13字节变成8字节<br>
<strong>需要结合下面decode过程一起理解，很容易算错，建议检验一下</strong><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/kyber_encode_12_8.png" alt="alt text"><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_encode_13_8.png" alt="alt text"></p>
<h4 id="修改的代码-1">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_sk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token comment">//-- 512 coefficients require 64 addresses</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    s_m_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">104</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">104</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">98</span><span class="token punctuation">:</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">:</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">:</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">:</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">:</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">:</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              s_m_reg_s_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h3 id="3算法4中-keygen_encode_pk参数修改">3.算法4中 KeyGen_Encode_pk参数修改 </h3>
<h4 id="原来的代码-3">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_pk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">4'd0</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      rho_reg <span class="token operator">&lt;=</span> g_rho<span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      t_c_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">96</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">:</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">75</span><span class="token punctuation">:</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">92</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">:</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>pk</mtext><mo>:</mo><mo>=</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mtext>Encode</mtext><mn>12</mn></msub><msup><mrow><mo fence="true">(</mo><mover accent="true"><mi>t</mi><mo>^</mo></mover><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><msubsup><mtext> </mtext><mi>q</mi><mo>+</mo></msubsup><mo fence="true">)</mo></mrow><mi>k</mi></msup><mtext> </mtext><mi>ρ</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">\text{pk} := \bigl( \text{Encode}_{12} \left( \hat{t} \bmod^+_q \right)^k \, \rho \bigr)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5006em;vertical-align:-0.3831em;"></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mspace" style="margin-right:0.0556em;"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1175em;"><span style="top:-3.3314em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ρ</span><span class="mclose"><span class="delimsizing size1">)</span></span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>pk</mtext><mo>:</mo><mo>=</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>t</mi></msub></msub><mrow><mo fence="true">(</mo><msub><mrow><mo fence="true">⌈</mo><mi>t</mi><mo fence="true">⌋</mo></mrow><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow></msub><mo fence="true">)</mo></mrow><mo>∥</mo><mi>ρ</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\text{pk} := \bigl( \text{Encode}_{d_t} \left( \left\lceil t \right\rfloor_{q \to 2^{d_t}} \right) \parallel \rho \bigr) ;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mord mathnormal">t</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2581em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal">ρ</span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mpunct">;</span></span></span></span></span><br>
也就是说，原本是从12位变成8位<br>
现在aigis需要从10位变成8位,且总共的位数是80位<br>
类似kyber的 <code>Enc_Encode_c</code></p>
<h4 id="修改的代码-2">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_pk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">4'd0</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      rho_reg <span class="token operator">&lt;=</span> g_rho<span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      t_c_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">80</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">:</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">:</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">:</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              t_c_reg_t_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h3 id="4算法-5-aigis-pkeencpk-μ-r加密算法中-enc_encode_c参数修改">4.算法 5: Aigis-pke.Enc(pk, µ; r)：加密算法中 Enc_Encode_c参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mspace width="1em"></mspace><msub><mi>c</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mtext>Compress</mtext><mi>q</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>u</mi></msub><mo stretchy="false">)</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mspace linebreak="newline"></mspace><mspace width="1em"></mspace><msub><mi>c</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mtext>Compress</mtext><mi>q</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">\quad c_1 := \text{Encode}_{d_u} \bigl( \text{Compress}_q(u, d_u) \bigr) \\
\quad c_2 := \text{Encode}_{d_v}\bigl( \text{Compress}_q(v, d_v) \bigr)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing size1">)</span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing size1">)</span></span></span></span></span></span></p>
<p>改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"></mspace><msub><mi>c</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mo stretchy="false">⌈</mo><mi>u</mi><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup></mrow></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mtext> </mtext><mo separator="true">;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"></mspace><msub><mi>c</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mo stretchy="false">⌈</mo><mi>v</mi><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup></mrow></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mtext> </mtext><mo separator="true">;</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\quad c_1 &amp;:= \text{Encode}_{d_u} \bigl( \lceil u \rfloor_{q \to 2^{d_u}} \bigr) \, ; \\
\quad c_2 &amp;:= \text{Encode}_{d_v} \bigl( \lceil v \rfloor_{q \to 2^{d_v}}\bigr) \, ;
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.02em;vertical-align:-1.26em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.76em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.26em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.76em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mopen">⌈</span><span class="mord mathnormal">u</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">u</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">;</span></span></span><span style="top:-2.4em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mopen">⌈</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.26em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>也就是说，原本是c1从10位变成8位，总共80位；aigis需要改成9位变成8位，总共72位<br>
c2从4位变成8位，总共32位；aigis需要改成3位变成8位，总共24位</p>
<h4 id="推理过程-1">推理过程： </h4>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_encode_9_8.png" alt="alt text"><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_encode_3_8.png" alt="alt text"></p>
<h4 id="原来的代码-位置顺序">原来的代码 位置顺序： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Enc_Encode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token comment">//-- c1:10*256*2, each coefficient is 10b, a total of 256*2 coefficients;</span>
  <span class="token comment">//-- Each pass has 8 coefficients, and it needs to be passed 64 times</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">32</span><span class="token operator">*</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">:</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">:</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">:</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
  <span class="token comment">//-- c2:4*256, each coefficient is 4b, a total of 256 coefficients;</span>
  <span class="token comment">//-- Each pass has 8 coefficients, and it needs to be passed 32 times</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    t_c_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">32</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">08</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">07</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h4 id="原来的代码-逻辑">原来的代码 逻辑： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Enc_Encode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7'd0</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype     <span class="token operator">=</span> <span class="token number">4'd10</span><span class="token punctuation">;</span>
      ram_raddr <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype                 <span class="token operator">=</span> <span class="token number">4'd10</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
      t_c_reg_u_in<span class="token punctuation">[</span><span class="token number">64</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d10<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype                <span class="token operator">=</span> <span class="token number">4'd4</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_9_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">7'd64</span><span class="token punctuation">;</span>
      t_c_reg_u_in<span class="token punctuation">[</span><span class="token number">64</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d10<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
      dtype                <span class="token operator">=</span> <span class="token number">4'd4</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_9_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">7'd64</span><span class="token punctuation">;</span>
      t_c_reg_v_in<span class="token punctuation">[</span><span class="token number">96</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d4<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span>
    last_cycle <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd96</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码-3">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Enc_Encode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  <span class="token comment">//-- c1:9*256*2, each coefficient is 9b, a total of 256*2 coefficients;</span>
  <span class="token comment">//-- Each pass has 8 coefficients, and it needs to be passed 64 times</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">72</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">:</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">:</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">:</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                    t_c_reg_u_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
  <span class="token comment">//-- c2:3*256, each coefficient is 3b, a total of 256 coefficients;</span>
  <span class="token comment">//-- Each pass has 8 coefficients, and it needs to be passed 32 times</span>
  <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
    t_c_reg<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">24</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token operator">{</span>t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                            t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">06</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">05</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg_v_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">08</span><span class="token punctuation">:</span><span class="token number">07</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h4 id="修改的代码-逻辑">修改的代码 逻辑： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Enc_Encode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7'd0</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype     <span class="token operator">=</span> <span class="token number">4'd9</span><span class="token punctuation">;</span>
      ram_raddr <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype                 <span class="token operator">=</span> <span class="token number">4'd9</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
      t_c_reg_u_in<span class="token punctuation">[</span><span class="token number">64</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d10<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      dtype                <span class="token operator">=</span> <span class="token number">4'd3</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_9_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">7'd64</span><span class="token punctuation">;</span>
      t_c_reg_u_in<span class="token punctuation">[</span><span class="token number">64</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d10<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
      dtype                <span class="token operator">=</span> <span class="token number">4'd3</span><span class="token punctuation">;</span>
      ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_9_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">7'd64</span><span class="token punctuation">;</span>
      t_c_reg_v_in<span class="token punctuation">[</span><span class="token number">96</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d4<span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span>
    last_cycle <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd96</span><span class="token punctuation">;</span>
</code></pre><h3 id="5算法-6-aigis-pkedecsk-c解密算法中-dec_encode_m参数修改">5.算法 6: Aigis-pke.Dec(sk, c)：解密算法中 Dec_Encode_m参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><mn>1</mn></msub><mrow><mo fence="true">(</mo><msub><mtext>Compress</mtext><mi>q</mi></msub><mrow><mo fence="true">(</mo><mi>v</mi><mo>−</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mtext>NTT</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">m := \text{Encode}_1\left(\text{Compress}_q\left( v - \text{NTT}^{-1} \left( \hat{s}^T \circ \text{NTT}(u) \right), 1 \right) \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2716em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">NTT</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>μ</mi><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><mn>1</mn></msub><mrow><mo fence="true">(</mo><msub><mrow><mo fence="true">⌈</mo><mi>v</mi><mo>−</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mtext>NTT</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">⌋</mo></mrow><mrow><mi>q</mi><mo>→</mo><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu := \text{Encode}_1\left( \left\lceil v - \text{NTT}^{-1} \left( \hat{s}^T \circ \text{NTT}(u) \right) \right\rfloor_{q \to 2} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⌈</span></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">NTT</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⌋</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0514em;"><span style="top:-2.3003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5358em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p>
<p>也就是说，原本是m从1位变成8位，总共8位；aigis需要改成1位变成8位，总共8位，所以其实不变</p>
<h3 id="6算法-5-aigis-pkeencpk-μ-r加密算法-中-enc_decode_pk参数修改">6.算法 5: Aigis-pke.Enc(pk, µ; r)：加密算法 中 Enc_Decode_pk参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>:</mo><mo>=</mo><msub><mtext>Decode</mtext><mn>12</mn></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t := \text{Decode}_{12}(\text{pk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>:</mo><mo>=</mo><msub><mrow><mo fence="true">⌈</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>t</mi></msub></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo><mo fence="true">⌋</mo></mrow><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t := \left\lceil \text{Decode}_{d_t}(\text{pk}) \right\rfloor_{{2^{d_t}}  \rightarrow q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1859em;vertical-align:-0.4359em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.258em;"><span style="top:-2.4002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4359em;"><span></span></span></span></span></span></span></span></span></span></span><br>
也就是说，原本是pk从8位变成12位，总共96位；aigis需要改成8位变成13位，总共104位</p>
<h4 id="推理过程-2">推理过程： </h4>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/kyber_decode_8_12.png" alt="alt text"><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_decode_8_10.png" alt="alt text"></p>
<h4 id="原来的代码-4">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign t_c_reg_t[j] = t_c_reg[(j*96+95):(j*96)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> t_c_reg_t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码-4">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign t_c_reg_t[j] = t_c_reg[(j*104+103):(j*104)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> t_c_reg_t<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">73</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">93</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">74</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_c_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="7算法-5-aigis-pkeencpk-μ-r加密算法-中-enc_decode_m参数修改">7.算法 5: Aigis-pke.Enc(pk, µ; r)：加密算法 中 Enc_Decode_m参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><msup><mover accent="true"><mi>t</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>e</mi><mn>2</mn></msub><mo>+</mo><msub><mtext>Decompress</mtext><mi>q</mi></msub><mrow><mo fence="true">(</mo><msub><mtext>Decode</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>1</mn><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">v := \text{NTT}^{-1} \left( \hat{t}^T \circ \hat{r} \right) + e_2 + \text{Decompress}_q \left( \text{Decode}_1(m), 1 \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2413em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Decompress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">(</mo><mtext>NTT</mtext><mo stretchy="false">(</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>e</mi><mn>2</mn></msub><mo>+</mo><mrow><mo fence="true">⌈</mo><mfrac><mn>2</mn><mi>q</mi></mfrac><mo fence="true">⌋</mo></mrow><mo>⋅</mo><msub><mtext>Decode</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v := \text{NTT}^{-1} \left( \text{NTT}(t)^T \circ \hat{r} \right) + e_2 + \left\lceil\frac{2}{q} \right\rfloor \cdot \text{Decode}_1(\mu)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2413em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord text"><span class="mord">NTT</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌈</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌋</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mclose">)</span></span></span></span></span><br>
也就是说，原本是m从8位变成1位，总共8位；aigis也是8位变成1位，总共8位，所以不需要改变</p>
<h3 id="8算法-6-aigis-pkedecsk-c解密算法-中-dec_decode_sk参数修改">8.算法 6: Aigis-pke.Dec(sk, c)：解密算法 中 Dec_Decode_sk参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>s</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msub><mtext>Decode</mtext><mn>12</mn></msub><mo stretchy="false">(</mo><mi>s</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{s} := \text{Decode}_{12}(sk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>s</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msub><mtext>Decode</mtext><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo></mrow></msub><mo stretchy="false">(</mo><mi>s</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{s} := \text{Decode}_{\lceil \log_2 q \rceil}(sk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1163em;vertical-align:-0.3663em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3663em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span><br>
也就是说，原本是m从8位变成12位，总共96位；aigis是从8位变成13位，总共104位，和上面 6.算法 5: Aigis-pke.Enc(pk, µ; r)：加密算法 中 Enc_Decode_pk参数修改 相似</p>
<h4 id="原来的代码-5">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign s_m_reg_s[j] = s_m_reg[(j*96+95):(j*96)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> s_m_reg_s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">96</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码-5">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign s_m_reg_s[j] = s_m_reg[(j*104+103):(j*104)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> s_m_reg_s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">73</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">93</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">74</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s_m_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">104</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="9算法-6-aigis-pkedecsk-c解密算法-中-dec_decode_c参数修改">9.算法 6: Aigis-pke.Dec(sk, c)：解密算法 中 Dec_Decode_c参数修改 </h3>
<p>需要将原本的<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>u</mi><mo>:</mo><mo>=</mo><msub><mtext>Decompress</mtext><mi>q</mi></msub><mrow><mo fence="true">(</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>d</mi><mi>u</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">u := \text{Decompress}_q \left( \text{Decode}_{d_u}(c), d_u \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Decompress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msub><mtext>Decompress</mtext><mi>q</mi></msub><mrow><mo fence="true">(</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mrow><mo fence="true">(</mo><mi>c</mi><mo>+</mo><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mfrac><mi>n</mi><mn>8</mn></mfrac><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mi>d</mi><mi>v</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">v := \text{Decompress}_q \left( \text{Decode}_{d_v} \left( c + d_u \cdot k \cdot \frac{n}{8} \right), d_v \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.836em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord text"><span class="mord">Decompress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span><br>
改成<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>u</mi><mo>:</mo><mo>=</mo><msub><mrow><mo fence="true">⌈</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo fence="true">⌋</mo></mrow><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u := \left\lceil\text{Decode}_{d_u}(c) \right\rfloor_{2^{d_u} \to q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1859em;vertical-align:-0.4359em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2476em;"><span style="top:-2.4002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">u</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4359em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msub><mrow><mo fence="true">⌈</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mrow><mo fence="true">(</mo><mi>c</mi><mo>+</mo><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mfrac><mi>n</mi><mn>8</mn></mfrac><mo fence="true">)</mo></mrow><mo fence="true">⌋</mo></mrow><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v := \left\lceil\text{Decode}_{d_v} \left( c + d_u \cdot k \cdot \frac{n}{8} \right) \right\rfloor_{2^{d_v} \to q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0218em;vertical-align:-0.8718em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">⌈</span></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">⌋</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.1883em;"><span style="top:-1.9643em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8718em;"><span></span></span></span></span></span></span></span></span></span></span><br>
也就是说，原本是c从8位变成10+4位，总共80+32位；aigis是从8位变成9+3位，总共72+24位<br>
根据aigis-enc中的描述可知此处第一行的c是c1,第二行的c是c2。<br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/image-6.png" alt="alt text"></p>
<h4 id="推理过程-3">推理过程： </h4>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_decode_8_9.png" alt="alt text"><br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_decode_8_3.png" alt="alt text"></p>
<h4 id="原来的代码dec_decode_c1">原来的代码Dec_Decode_c1： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign t_c_reg_u[j] = decode_u_reg[(j*80+79):(j*80)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> t_c_reg_u<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">72</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">80</span><span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码dec_decode_c1">修改的代码Dec_Decode_c1： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code><span class="token comment">//-- assign t_c_reg_u[j] = decode_u_reg[(j*72+71):(j*72)];</span>
<span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
<span class="token keyword keyword-assign">assign</span> t_c_reg_u<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">49</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">57</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_u_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">72</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="原来的代码dec_decode_c2">原来的代码Dec_Decode_c2： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Dec_Decode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    ram_we        <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cnt <span class="token operator">!=</span> <span class="token number">7'd0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> <span class="token number">7'd65</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1'b1</span> <span class="token punctuation">:</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
    ram_waddr     <span class="token operator">=</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd65</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token constant">`RAM_12_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">10'd1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token constant">`RAM_12_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">10'd2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ram_wdata     <span class="token operator">=</span> decomp_out_data<span class="token punctuation">;</span>
    dtype         <span class="token operator">=</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd65</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">4'd10</span> <span class="token punctuation">:</span> <span class="token number">4'd4</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      decomp_in_d10 <span class="token operator">=</span> t_c_reg_u<span class="token punctuation">[</span><span class="token number">63</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      decomp_in_d4  <span class="token operator">=</span> t_c_reg_v<span class="token punctuation">[</span><span class="token number">96</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span>
    last_cycle <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd97</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码dec_decode_c2">修改的代码Dec_Decode_c2： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>Dec_Decode_c<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    ram_we        <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cnt <span class="token operator">!=</span> <span class="token number">7'd0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> <span class="token number">7'd65</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1'b1</span> <span class="token punctuation">:</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
    ram_waddr     <span class="token operator">=</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd65</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token constant">`RAM_12_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">10'd1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token constant">`RAM_12_OFFSET</span> <span class="token operator">+</span> cnt <span class="token operator">-</span> <span class="token number">10'd2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ram_wdata     <span class="token operator">=</span> decomp_out_data<span class="token punctuation">;</span>
    dtype         <span class="token operator">=</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd65</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">4'd9</span> <span class="token punctuation">:</span> <span class="token number">4'd3</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      decomp_in_d10 <span class="token operator">=</span> t_c_reg_u<span class="token punctuation">[</span><span class="token number">63</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&gt;</span> <span class="token number">7'd64</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      decomp_in_d4  <span class="token operator">=</span> t_c_reg_v<span class="token punctuation">[</span><span class="token number">96</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span>
    last_cycle <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd97</span><span class="token punctuation">;</span>
</code></pre><h4 id="原来的代码-逻辑-1">原来的代码 逻辑： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  <span class="token comment">//-- assign t_c_reg_v[j] = decode_v_reg[(j*32+31):(j*32)];</span>
  <span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
  <span class="token keyword keyword-assign">assign</span> t_c_reg_v<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">03</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">04</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="修改的代码-逻辑-1">修改的代码 逻辑： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  <span class="token comment">//-- assign t_c_reg_v[j] = decode_v_reg[(j*24+33):(j*24)];</span>
  <span class="token comment">//-- Coefficients are stored in big-endian mode, and vectors with high-level labels store low-power coefficients</span>
  <span class="token keyword keyword-assign">assign</span> t_c_reg_v<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">09</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">01</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">04</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">02</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> decode_v_reg<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">07</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">24</span><span class="token operator">+</span><span class="token number">05</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="10修改compress的参数">10.修改compress的参数 </h3>
<p>kyber文档中表示压缩和解压缩的功能其实和aigis的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>t</mi><msub><mo stretchy="false">⌉</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow></msub></mrow><annotation encoding="application/x-tex">\lfloor t \rceil_{q \to 2^{d_t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span>一样，具体如下两张图：<br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/kyber_compression.png" alt="alt text"></p>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_模切换.png" alt="alt text"><br>
<strong>compress部分：</strong></p>
<ul>
<li>kyber 进行大到小的模切换是从q=3329切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>10</mn></msup><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^{10}=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span></li>
<li>aigis 进行大到小的模切换是从q=7681切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^3=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>9</mn></msup><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^9=512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">512</span></span></span></span></li>
</ul>
<p><strong>decompress部分：</strong></p>
<ul>
<li>kyber 进行大到小的模切换是从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>10</mn></msup><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^{10}=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span>切换到q=3329</li>
<li>aigis 进行大到小的模切换是从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>10</mn></msup><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">2^{d_t}=2^{10}=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^3=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>9</mn></msup><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^9=512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">512</span></span></span></span>切换到q=7681</li>
</ul>
<h4 id="compress的位数修改-compressv文件修改">compress的位数修改 compress.v文件修改 </h4>
<h5 id="原来的代码-6">原来的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  <span class="token punctuation">(</span>
   <span class="token keyword keyword-input">input</span>         clk<span class="token punctuation">,</span>
   <span class="token keyword keyword-input">input</span>         rst<span class="token punctuation">,</span>
   <span class="token keyword keyword-input">input</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  in_data<span class="token punctuation">,</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  out_data_d1<span class="token punctuation">,</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> out_data_d4<span class="token punctuation">,</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> out_data_d10
   <span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">//-- input reg</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg     <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg4    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg4_d  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg10   <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg10_d <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>     out_reg10  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   subtrahend4<span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   subtrahend10<span class="token punctuation">;</span>
</code></pre><h5 id="修改的代码-6">修改的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>  <span class="token punctuation">(</span>
   <span class="token keyword keyword-input">input</span>         clk<span class="token punctuation">,</span>
   <span class="token keyword keyword-input">input</span>         rst<span class="token punctuation">,</span>
   <span class="token keyword keyword-input">input</span> <span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  in_data<span class="token punctuation">,</span> <span class="token comment">//13*8</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  out_data_d1<span class="token punctuation">,</span> <span class="token comment">//1*8</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> out_data_d4<span class="token punctuation">,</span> <span class="token comment">//3*8</span>
   <span class="token keyword keyword-output">output</span> <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> out_data_d10 <span class="token comment">//9*8</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">//-- input reg</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg     <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//13位</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg4    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg4_d  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg10   <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>    in_reg10_d <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-reg">reg</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>     out_reg10  <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   subtrahend4<span class="token punctuation">;</span>
   <span class="token keyword keyword-wire">wire</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   subtrahend10<span class="token punctuation">;</span>
</code></pre><h4 id="a-从q3329切换到--212-修改成-从q7681切换到--212">a. 从q=3329切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> 修改成 从q=7681切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> </h4>
<h5 id="原来的代码-7">原来的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token comment">//-- in_reg</span>
   <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword keyword-posedge">posedge</span> clk <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-posedge">posedge</span> rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
         in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">12'd0</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
         in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">:</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

    <span class="token comment">//assign out_data_d1 = {  mul_out[7][22], mul_out[6][22], mul_out[5][22], mul_out[4][22],</span>
   <span class="token comment">//                        mul_out[3][22], mul_out[2][22], mul_out[1][22], mul_out[0][22] } ; // mul_out &gt;&gt; 22</span>

   <span class="token comment">//-- Move directly to the right is rounded down, and the comparison size is rounded</span>
   <span class="token comment">//--  0~3328 maps to 0~1, [0, 0.5) is 0, [0.5, 1.5) is 1, [1.5, 2) is 0; 3329 corresponds to 0.5 points and 1.5 points, which are 832.25 and 2496.75</span>

   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd832</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd2497</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h5 id="修改的逻辑">修改的逻辑 </h5>
<p>kyber: <code>0~3328</code> maps to <code>0~1</code>, <code>[0, 0.5)</code> is <code>0</code>, <code>[0.5, 1.5)</code> is <code>1</code>, <code>[1.5, 2)</code> is <code>0</code>; <code>3329 </code>corresponds to <code>0.5</code> points and <code>1.5</code> points, which are <code>3329*0.5/2=832.25</code> and <code>3329*1.5/2=2496.75</code><br>
aigis: <code>0~7681</code> maps to <code>0~1</code>, <code>[0, 0.5)</code> is <code>0</code>, <code>[0.5, 1.5)</code> is <code>1</code>, <code>[1.5, 2)</code> is <code>0</code>; <code>7681</code> corresponds to <code>0.5</code> points and <code>1.5</code> points, which are <code>7681*0.5/2=1920.25</code> and <code>7681*1.5/2=5760.75</code></p>
<h5 id="修改的代码-7">修改的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token comment">//-- in_reg</span>
   <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword keyword-posedge">posedge</span> clk <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-posedge">posedge</span> rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
         in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">13'd0</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
         in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">:</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">:</span><span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_data<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

  

   <span class="token comment">//-- Move directly to the right is rounded down, and the comparison size is rounded</span>
   <span class="token comment">//--  0~7681 maps to 0~1, [0, 0.5) is 0, [0.5, 1.5) is 1, [1.5, 2) is 0; 7681 corresponds to 0.5 points and 1.5 points, which are 1920.25 and 5760.75</span>

   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12'd1920</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>in_reg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">12'd5761</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>kyber 进行大到小的模切换是从q=3329切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>1</mn></msup><mn>0</mn><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^10=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span></li>
<li>aigis 进行大到小的模切换是从q=7681切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^1=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^3=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span>、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>9</mn></msup><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^9=512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">512</span></span></span></span></li>
</ul>
<h4 id="b-从q3329切换到--2d_u2416修改成-从q7681切换到--2d_u238">b. 从q=3329切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>修改成 从q=7681切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2^{d_u}=2^3=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span> </h4>
<h5 id="原来的代码-8">原来的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token keyword keyword-assign">assign</span> subtrahend4  <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">8'd208</span><span class="token punctuation">,</span> <span class="token number">5'd0</span><span class="token operator">}</span><span class="token punctuation">;</span>

   <span class="token comment">//-- in_reg4: 8 组 17 位寄存器，用于存储处理后的输入数据</span>
   <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword keyword-posedge">posedge</span> clk <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-posedge">posedge</span> rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
         <span class="token comment">// 复位时，所有寄存器清零</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
         <span class="token comment">// 非复位时，更新寄存器值</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

   <span class="token comment">//-- 组合逻辑块：计算 in_reg4_d</span>
   <span class="token important">always @</span><span class="token punctuation">(</span>in_data<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token comment">// **拆分 in_data，每 12 位一组，并加上 103**</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">:</span><span class="token number">72</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">84</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>

      <span class="token comment">// **循环处理 in_reg4_d，使其进行5次左移并进行修正**</span>
      <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span> <span class="token comment">// 处理 8 个寄存器数据</span>
         <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span> <span class="token comment">// 进行 5 次移位和修正</span>
            in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1'b0</span><span class="token operator">}</span><span class="token punctuation">;</span><span class="token comment">// **左移 1 位**</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> subtrahend4<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
                <span class="token comment">// **如果值大于等于 subtrahend4，则执行减法修正**</span>
               in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> subtrahend4 <span class="token operator">+</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-end">end</span>
         <span class="token keyword keyword-end">end</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

      <span class="token comment">//assign out_data_d4 = {mul_out[7][22:19], mul_out[6][22:19], mul_out[5][22:19], mul_out[4][22:19],</span>
   <span class="token comment">//                      mul_out[3][22:19], mul_out[2][22:19], mul_out[1][22:19], mul_out[0][22:19]}; // mul_out &gt;&gt; 19</span>
   <span class="token comment">//-- 输出信号：仅保留 in_reg4 每个寄存器的低 4 位，并拼接为 32 位输出</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d4 <span class="token operator">=</span> <span class="token operator">{</span>in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h5 id="修改的逻辑-1">修改的逻辑 </h5>
<p>kyber: <code>3329</code><br>
aigis: <code>0~7681</code> maps to <code>0~1</code>, <code>[0, 0.5)</code> is <code>0</code>, <code>[0.5, 1.5)</code> is <code>1</code>, <code>[1.5, 2)</code> is <code>0</code>; <code>7681</code> corresponds to <code>0.5</code> points and <code>1.5</code> points, which are <code>7681*0.5/2=1920.25</code> and <code>7681*1.5/2=5760.75</code></p>
<h5 id="修改的代码-8">修改的代码 </h5>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>   <span class="token keyword keyword-assign">assign</span> subtrahend4  <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">8'd208</span><span class="token punctuation">,</span> <span class="token number">5'd0</span><span class="token operator">}</span><span class="token punctuation">;</span>

   <span class="token comment">//-- in_reg4: 8 组 17 位寄存器，用于存储处理后的输入数据</span>
   <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword keyword-posedge">posedge</span> clk <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-posedge">posedge</span> rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>rst<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
         <span class="token comment">// 复位时，所有寄存器清零</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">17'd0</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-begin">begin</span>
         <span class="token comment">// 非复位时，更新寄存器值</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> in_reg4_d<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

   <span class="token comment">//-- 组合逻辑块：计算 in_reg4_d</span>
   <span class="token important">always @</span><span class="token punctuation">(</span>in_data<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
      <span class="token comment">// **拆分 in_data，每 12 位一组，并加上 103**</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">83</span><span class="token punctuation">:</span><span class="token number">72</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
      in_reg4_d<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">5'd0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>in_data<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">84</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12'd103</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>

      <span class="token comment">// **循环处理 in_reg4_d，使其进行5次左移并进行修正**</span>
      <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span> <span class="token comment">// 处理 8 个寄存器数据</span>
         <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span> <span class="token comment">// 进行 5 次移位和修正</span>
            in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">{</span>in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1'b0</span><span class="token operator">}</span><span class="token punctuation">;</span><span class="token comment">// **左移 1 位**</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> subtrahend4<span class="token punctuation">)</span> <span class="token keyword keyword-begin">begin</span>
                <span class="token comment">// **如果值大于等于 subtrahend4，则执行减法修正**</span>
               in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> in_reg4_d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> subtrahend4 <span class="token operator">+</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-end">end</span>
         <span class="token keyword keyword-end">end</span>
      <span class="token keyword keyword-end">end</span>
   <span class="token keyword keyword-end">end</span>

      <span class="token comment">//assign out_data_d4 = {mul_out[7][22:19], mul_out[6][22:19], mul_out[5][22:19], mul_out[4][22:19],</span>
   <span class="token comment">//                      mul_out[3][22:19], mul_out[2][22:19], mul_out[1][22:19], mul_out[0][22:19]}; // mul_out &gt;&gt; 19</span>
   <span class="token comment">//-- 输出信号：仅保留 in_reg4 每个寄存器的低 4 位，并拼接为 32 位输出</span>
   <span class="token keyword keyword-assign">assign</span> out_data_d4 <span class="token operator">=</span> <span class="token operator">{</span>in_reg4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                         in_reg4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in_reg4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="c-从q3329切换到-2d_v2101024修改成-从q7681切换到--2d_v29512">c. 从q=3329切换到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>1</mn></msup><mn>0</mn><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^10=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span>修改成 从q=7681切换到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup><mo>=</mo><msup><mn>2</mn><mn>9</mn></msup><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">2^{d_v}=2^9=512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">512</span></span></span></span> </h4>
<h2 id="4-aigis-pkekeygen-和-kybercpapkekeygen-密钥生成算法的比较">4 Aigis-pke.KeyGen() 和 Kyber.CPAPKE.KeyGen() 密钥生成算法的比较 </h2>
<h3 id="41-密钥和参数的大小">4.1 <strong>密钥和参数的大小</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li><strong>公钥</strong>的大小是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mi>d</mi><mi>t</mi><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{dt \cdot k \cdot n / 8 + n / 8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 是算法的参数。</li>
<li><strong>私钥</strong>的大小是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{\lceil \log_2 q \rceil \cdot k \cdot n / 8 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 是模数。</li>
</ul>
</li>
<li>
<p><strong>Kyber.CPAPKE</strong>:</p>
<ul>
<li><strong>公钥</strong>的大小是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{12 \cdot k \cdot n / 8 + 32 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>私钥</strong>的大小是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{12 \cdot k \cdot n / 8 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
</ul>
<p>n都等于256，k都等于2，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">d_t=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span><br>
对照aigis的表格修改位数</p>
<h3 id="42-噪声采样">4.2 <strong>噪声采样</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li>使用 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">CBD_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 中采样噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 和 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">CBD_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 中采样噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>。</li>
<li>这里，噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> 的分布是基于不同的 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span></strong> 参数，表示不同的噪声幅度或密度。</li>
</ul>
</li>
<li>
<p><strong>Kyber.CPAPKE</strong>:</p>
<ul>
<li>只使用 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">CBD_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 中采样噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>，并且 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\eta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong> 用于定义噪声分布。<br>
<strong>推理过程:</strong><br>
所以修改其中对应控制选择CBD参数部分即可，但aigis中eta2对应12，则需要如下图将两个CBD相加<br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/CBD参数值变化.png" alt="alt text"></li>
</ul>
</li>
</ul>
<h4 id="原来的代码-9">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>CBD_st_e0<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token punctuation">(</span>kyber_mode <span class="token operator">==</span> kyber512<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'd1</span> <span class="token punctuation">:</span> <span class="token number">2'd2</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_6_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd2</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>                
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_e1 <span class="token punctuation">:</span> CBD_st_e0<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
CBD_st_e1<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token punctuation">(</span>kyber_mode <span class="token operator">==</span> kyber512<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'd1</span> <span class="token punctuation">:</span> <span class="token number">2'd2</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_7_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd3</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>               
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_INTT <span class="token punctuation">:</span> CBD_st_e1<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
    CBD_SAMPLE_finish <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h4 id="修改的代码-9">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>CBD_st_e00<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token number">2'd2</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_6_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd2</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>                
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_e1 <span class="token punctuation">:</span> CBD_st_e0<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
CBD_st_e01<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token number">2'd2</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_7_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd3</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>               
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_INTT <span class="token punctuation">:</span> CBD_st_e1<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
    CBD_SAMPLE_finish <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
CBD_st_e10<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token number">2'd3</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_6_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd2</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>                
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_e1 <span class="token punctuation">:</span> CBD_st_e0<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
CBD_st_e11<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
    
    CBD_num <span class="token operator">=</span> <span class="token number">2'd3</span><span class="token punctuation">;</span>
    CBD_ram_w_start_offset <span class="token operator">=</span> ram_7_offset<span class="token punctuation">;</span>
    CBD_input <span class="token operator">=</span> <span class="token operator">{</span>G_sigma<span class="token punctuation">,</span><span class="token number">8'd3</span><span class="token operator">}</span><span class="token punctuation">;</span>
    CBD_active <span class="token operator">=</span> <span class="token operator">~</span>CBD_finsh_reg<span class="token punctuation">;</span>

    CBD_rst <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>               
    CBD_nstate <span class="token operator">=</span> CBD_finsh_reg <span class="token operator">?</span> CBD_st_INTT <span class="token punctuation">:</span> CBD_st_e1<span class="token punctuation">;</span>
    CBD_E_finish<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
    CBD_SAMPLE_finish <span class="token operator">=</span> CBD_finsh_reg<span class="token punctuation">;</span>
  
<span class="token keyword keyword-end">end</span>
<span class="token comment">//然后需要弄一个相加的</span>
</code></pre><h3 id="43-ntt-的使用与逆-ntt-的使用">4.3 <strong>NTT 的使用与逆 NTT 的使用</strong> </h3>
<p><strong>Aigis-enc</strong>：对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 进行 NTT 转换，结果在时域中处理噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>； 使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{NTT}^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8873em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 将结果从频域转换回时域，然后处理噪声。<br>
<strong>Kyber</strong> ：对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> 都进行 NTT 转换，所有操作均在频域完成；无需逆 NTT 操作，直接在频域中加噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>e</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>。</p>
<h4 id="原来的代码删去如下这一部分">原来的代码：删去如下这一部分 </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>NTT_st_NTT_e0<span class="token punctuation">:</span><span class="token keyword keyword-begin">begin</span>
  ram_w_sel_ntt <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
  ram_r_sel_ntt <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
  ntt_mode      <span class="token operator">=</span> <span class="token constant">`FORWARD_NTT_MODE</span><span class="token punctuation">;</span>

  ntt_ram_r_offset_a <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span><span class="token punctuation">;</span>
  ntt_ram_r_offset_b <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span><span class="token punctuation">;</span>
  ntt_ram_w_offset   <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span><span class="token punctuation">;</span>

  ntt_start_set <span class="token operator">=</span> <span class="token operator">~</span>ntt_finish_reg<span class="token punctuation">;</span>
  ntt_rst       <span class="token operator">=</span> ntt_finish_reg<span class="token punctuation">;</span>
  ntt_nstate    <span class="token operator">=</span> ntt_finish_reg <span class="token operator">?</span> NTT_st_NTT_e1 <span class="token punctuation">:</span> NTT_st_NTT_e0<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
NTT_st_NTT_e1<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  ram_w_sel_ntt <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
  ram_r_sel_ntt <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
  ntt_mode      <span class="token operator">=</span> <span class="token constant">`FORWARD_NTT_MODE</span><span class="token punctuation">;</span>

  ntt_ram_r_offset_a <span class="token operator">=</span> <span class="token constant">`RAM_7_OFFSET</span><span class="token punctuation">;</span>
  ntt_ram_r_offset_b <span class="token operator">=</span> <span class="token constant">`RAM_7_OFFSET</span><span class="token punctuation">;</span>
  ntt_ram_w_offset   <span class="token operator">=</span> <span class="token constant">`RAM_7_OFFSET</span><span class="token punctuation">;</span>

  ntt_start_set <span class="token operator">=</span> <span class="token operator">~</span>ntt_finish_reg<span class="token punctuation">;</span>
  ntt_rst       <span class="token operator">=</span> ntt_finish_reg<span class="token punctuation">;</span>
  ntt_se_finish <span class="token operator">=</span> ntt_finish_reg<span class="token punctuation">;</span>
  ntt_nstate    <span class="token operator">=</span> ntt_finish_reg <span class="token operator">?</span> NTT_st_INTT_2 <span class="token punctuation">:</span> NTT_st_NTT_e1<span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
</code></pre><p>然后对 <code>NTT_st_ADD_t0</code>和<code>NTT_st_ADD_t1</code>这部分的结果做INTT（增加一个INTT的过程）,然后再相应的加<code>e0</code>和<code>e1</code>,需要修改掉<code>NTT_st_ADD_e0</code>和<code>NTT_st_ADD_e0</code>两部分（修改两个NTT加的部分）</p>
<h3 id="44-编码方式">4.4 编码方式 </h3>
<p><strong>Aigis-enc</strong>： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 经过模切换操作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>t</mi><msub><mo stretchy="false">⌉</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow></msub></mrow><annotation encoding="application/x-tex">\lfloor t \rceil_{q \to 2^{d_t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span> 后，将结果压缩到更小的域（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow><annotation encoding="application/x-tex">2^{d_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>）。然后通过编码方法 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>d</mi><msub><mi>e</mi><msub><mi>d</mi><mi>t</mi></msub></msub></mrow><annotation encoding="application/x-tex">Encode_{d_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9445em;vertical-align:-0.2501em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">n</span><span class="mord mathnormal">co</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span> 处理 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，最后将其与随机数种子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 拼接生成公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext></mrow><annotation encoding="application/x-tex">\text{pk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span></span></span></span>。<br>
<strong>Kyber</strong> ：公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 固定使用 12 比特进行编码。<br>
编码已经在上面第三板块修改好了，只需要加入模切换操作<br>
kyber文档中表示压缩的功能其实和aigis的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>t</mi><msub><mo stretchy="false">⌉</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow></msub></mrow><annotation encoding="application/x-tex">\lfloor t \rceil_{q \to 2^{d_t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span>一样，具体如下两张图：<br>
<img src="./Kyber 和 Aigis-enc的不同之处_files/kyber_compression.png" alt="alt text"></p>
<p><img src="./Kyber 和 Aigis-enc的不同之处_files/aigis_模切换.png" alt="alt text"><br>
所以加入模切换操作就是在coder.v中加入compress</p>
<h4 id="原来的代码-10">原来的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_pk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
  t_c_reg_t_in<span class="token punctuation">[</span><span class="token number">63</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> ram_rdata<span class="token punctuation">;</span>
  last_cycle           <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd63</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>
</code></pre><h4 id="修改的代码-10">修改的代码： </h4>
<pre data-role="codeBlock" data-info="verilog" class="language-verilog verilog"><code>KeyGen_Encode_pk<span class="token punctuation">:</span> <span class="token keyword keyword-begin">begin</span>
  ram_raddr            <span class="token operator">=</span> <span class="token constant">`RAM_6_OFFSET</span> <span class="token operator">+</span> cnt<span class="token punctuation">;</span>
  t_c_reg_t_in<span class="token punctuation">[</span><span class="token number">63</span><span class="token operator">-</span>cnt<span class="token punctuation">]</span> <span class="token operator">=</span> comp_out_d10<span class="token punctuation">;</span>
  last_cycle           <span class="token operator">=</span> cnt <span class="token operator">==</span> <span class="token number">7'd63</span><span class="token punctuation">;</span>
</code></pre><h3 id="43-总结区别">4.3 <strong>总结区别</strong> </h3>
<table>
<thead>
<tr>
<th><strong>方面</strong></th>
<th><strong>Aigis-enc</strong></th>
<th><strong>Kyber</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>NTT 的使用</strong></td>
<td>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 进行 NTT 转换，结果在时域中处理噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>。</td>
<td>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> 都进行 NTT 转换，所有操作均在频域完成。</td>
</tr>
<tr>
<td><strong>逆 NTT 的使用</strong></td>
<td>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{NTT}^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8873em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 将结果从频域转换回时域，然后处理噪声。</td>
<td>无需逆 NTT 操作，直接在频域中加噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>e</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>。</td>
</tr>
<tr>
<td><strong>噪声处理</strong></td>
<td>噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> 在时域中加到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>。</td>
<td>噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>e</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 在频域中加到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>。</td>
</tr>
<tr>
<td><strong>编码方式</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 经过舍入操作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>t</mi><msub><mo stretchy="false">⌉</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow></msub></mrow><annotation encoding="application/x-tex">\lfloor t \rceil_{q \to 2^{d_t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span> 后，将结果压缩到更小的域（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow><annotation encoding="application/x-tex">2^{d_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>）。然后通过编码方法 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Encodedt</mtext></mrow><annotation encoding="application/x-tex">\text{Encodedt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Encodedt</span></span></span></span></span> 处理 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，最后将其与随机数种子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 拼接生成公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext></mrow><annotation encoding="application/x-tex">\text{pk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span></span></span></span>。</td>
<td>公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 固定使用 12 比特进行编码。</td>
</tr>
<tr>
<td><strong>私钥编码</strong></td>
<td>私钥编码精度动态调整（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \log_2 q \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span></span></span></span>），与模数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的大小相关。</td>
<td>私钥编码精度固定为 12 比特，标准化更强。</td>
</tr>
<tr>
<td><strong>公钥生成</strong></td>
<td>在时域中生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，经过域压缩后编码为公钥，与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 拼接。</td>
<td>在频域中生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>，模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 后直接编码为公钥，与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 拼接。</td>
</tr>
<tr>
<td><strong>效率</strong></td>
<td>时域与频域的切换可能带来额外开销，效率稍低。</td>
<td>频域操作更高效，适合硬件实现。</td>
</tr>
</tbody>
</table>
<h3 id="44-总结表格">4.4 <strong>总结表格</strong> </h3>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-pke</strong></th>
<th><strong>Kyber.CPAPKE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{d_t \cdot k \cdot n / 8 + n / 8 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{12 \cdot k \cdot n / 8 + 32 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>私钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{\lceil \log_2 q \rceil \cdot k \cdot n / 8 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{12 \cdot k \cdot n / 8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>噪声采样</strong></td>
<td>从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 和 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 采样</td>
<td>仅从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></strong> 采样</td>
</tr>
<tr>
<td><strong>NTT 变换</strong></td>
<td>对矩阵和向量进行 <strong>NTT</strong> 变换</td>
<td>对矩阵和向量进行 <strong>NTT</strong> 变换</td>
</tr>
<tr>
<td><strong>公钥编码</strong></td>
<td>使用 <code>Encodedt</code> 进行编码</td>
<td>使用 <code>Encode12</code> 进行编码</td>
</tr>
<tr>
<td><strong>私钥编码</strong></td>
<td>使用 <code>Encode⌈log2 q⌉</code> 进行编码</td>
<td>使用 <code>Encode12</code> 进行编码</td>
</tr>
</tbody>
</table>
<p>参数值带入后</p>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-pke</strong></th>
<th><strong>Kyber.CPAPKE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mn>672</mn></msup></mrow><annotation encoding="application/x-tex">B^{672 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">672</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mn>800</mn></msup></mrow><annotation encoding="application/x-tex">B^{800}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>私钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mn>832</mn></msup></mrow><annotation encoding="application/x-tex">B^{832}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">832</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mn>768</mn></msup></mrow><annotation encoding="application/x-tex">B^{768}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">768</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>噪声采样</strong></td>
<td>从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>1</mn></msub></msub><mo>:</mo><msup><mi>B</mi><mn>128</mn></msup></mrow><annotation encoding="application/x-tex">CBD_{\eta_1} :B^{128}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span></span></span></span></strong> 和 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>2</mn></msub></msub><mo>:</mo><msup><mi>B</mi><mn>768</mn></msup></mrow><annotation encoding="application/x-tex">CBD_{\eta_2}:B^{768}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">768</span></span></span></span></span></span></span></span></span></span></span></span></strong> 采样</td>
<td>仅从 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>B</mi><msub><mi>D</mi><msub><mi>η</mi><mn>1</mn></msub></msub><mo>:</mo><msup><mi>B</mi><mn>192</mn></msup></mrow><annotation encoding="application/x-tex">CBD_{\eta_1}:B^{192}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">192</span></span></span></span></span></span></span></span></span></span></span></span></strong> 采样</td>
</tr>
<tr>
<td><strong>NTT 变换</strong></td>
<td>对矩阵和向量进行 <strong>NTT</strong> 变换</td>
<td>对矩阵和向量进行 <strong>NTT</strong> 变换</td>
</tr>
<tr>
<td><strong>公钥编码</strong></td>
<td>使用 <code>Encode_10</code> 进行编码</td>
<td>使用 <code>Encode12</code> 进行编码</td>
</tr>
<tr>
<td><strong>私钥编码</strong></td>
<td>使用 <code>Encode_13</code>_ 进行编码</td>
<td>使用 <code>Encode12</code> 进行编码</td>
</tr>
</tbody>
</table>
<h3 id="45-主要区别">4.5 <strong>主要区别</strong>： </h3>
<ul>
<li><strong>噪声采样</strong>：<strong>Aigis-pke</strong> 使用了两个不同的噪声分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，而 <strong>Kyber.CPAPKE</strong> 只使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><msub><mi>η</mi><mn>1</mn></msub></msub></mrow><annotation encoding="application/x-tex">B_{\eta_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>公钥和私钥的编码方式</strong>：两者的编码方式不同，尤其是 <strong>Aigis-pke</strong> 使用了更复杂的编码过程（<code>Encodedt</code> 和 <code>Encode⌈log2 q⌉</code>），而 <strong>Kyber.CPAPKE</strong> 使用了较简单的 <code>Encode12</code>。</li>
<li><strong>密钥大小</strong>：两者的密钥大小公式不同，公钥和私钥的存储要求也不同。</li>
</ul>
<h2 id="5-aigis-pkeencpk-μ-r-和-kybercpapkekeygen-加密算法的比较">5 Aigis-pke.Enc(pk, µ; r) 和 Kyber.CPAPKE.KeyGen() 加密算法的比较 </h2>
<h3 id="51-输入和参数表示"><strong>5.1 输入和参数表示</strong> </h3>
<h4 id="aigis-pke"><strong>Aigis-PKE</strong>： </h4>
<ul>
<li><strong>公钥</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext><mo>∈</mo><msub><mi>B</mi><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{pk} \in B_{d_t \cdot k \cdot n/8 + n/8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>明文</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>∈</mo><msub><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mu \in B_{n/8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>随机数</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>∈</mo><msub><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msub></mrow><annotation encoding="application/x-tex">r \in B_{n/8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="kybercpapke"><strong>Kyber.CPAPKE</strong>： </h4>
<ul>
<li><strong>公钥</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext><mo>∈</mo><msub><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{pk} \in B_{12 \cdot k \cdot n/8 + 32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>明文</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><msub><mi>B</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">m \in B_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>随机数</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>∈</mo><msub><mi>B</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">r \in B_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="区别"><strong>区别</strong>： </h4>
<ul>
<li>Aigis-PKE 的公钥和明文采用更灵活的表示形式，与参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">d_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 有关；Kyber.CPAPKE 的明文固定为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">B_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 位宽。</li>
<li>Aigis-PKE 的公钥中包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">d_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的信息，而 Kyber.CPAPKE 的公钥为固定大小 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">12 \cdot k \cdot n/8 + 32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span>。</li>
</ul>
<hr>
<h3 id="52-公钥解析和矩阵生成"><strong>5.2 公钥解析和矩阵生成</strong> </h3>
<h4 id="aigis-pke-1"><strong>Aigis-PKE</strong>： </h4>
<ul>
<li>公钥解析：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>:</mo><mo>=</mo><mo stretchy="false">⌊</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>t</mi></msub></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo><msub><mo stretchy="false">⌋</mo><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t := \lfloor \text{Decode}_{d_t}(\text{pk}) \rfloor_{2^{d_t} \to q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9468em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 的生成通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>XOF</mtext><mo stretchy="false">(</mo><mi>ρ</mi><mo>∥</mo><mi>j</mi><mo>∥</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{XOF}(\rho \parallel j \parallel i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">XOF</span></span><span class="mopen">(</span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 为随机种子，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo separator="true">,</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j, i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span></span></span></span> 为索引。</li>
</ul>
<h4 id="kybercpapke-1"><strong>Kyber.CPAPKE</strong>： </h4>
<ul>
<li>公钥解析：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msub><mtext>Decode</mtext><mn>12</mn></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{t} := \text{Decode}_{12}(\text{pk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span></span></span></span></li>
<li>矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9468em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> 的生成通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>XOF</mtext><mo stretchy="false">(</mo><mi>ρ</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{XOF}(\rho, i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">XOF</span></span><span class="mopen">(</span><span class="mord mathnormal">ρ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i, j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 构成种子。</li>
</ul>
<h4 id="区别-1"><strong>区别</strong>： </h4>
<ul>
<li>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>:</mo><mo>=</mo><mo stretchy="false">⌊</mo><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>t</mi></msub></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo><msub><mo stretchy="false">⌋</mo><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t := \lfloor \text{Decode}_{d_t}(\text{pk}) \rfloor_{2^{d_t} \to q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.3491em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.487em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7968em;"><span style="top:-2.8008em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6151em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2703em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3491em;"><span></span></span></span></span></span></span></span></span></span></strong></p>
<ul>
<li>从公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext></mrow><annotation encoding="application/x-tex">\text{pk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span></span></span></span> 中解析出值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，具体解析方法包括：
<ol>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Decode</mtext><msub><mi>d</mi><mi>t</mi></msub></msub></mrow><annotation encoding="application/x-tex">\text{Decode}_{d_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9445em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span> 函数解码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext></mrow><annotation encoding="application/x-tex">\text{pk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span></span></span></span>。</li>
<li>解码后的结果被从基数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>t</mi></msub></msup></mrow><annotation encoding="application/x-tex">2^{d_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 映射到模数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>。</li>
<li>最终取整操作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mo>⋅</mo><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor \cdot \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord">⋅</span><span class="mclose">⌋</span></span></span></span> 将结果舍入。</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msub><mtext>Decode</mtext><mn>12</mn></msub><mo stretchy="false">(</mo><mtext>pk</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{t} := \text{Decode}_{12}(\text{pk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">pk</span></span><span class="mclose">)</span></span></span></span></strong></p>
<ul>
<li>直接从公钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>pk</mtext></mrow><annotation encoding="application/x-tex">\text{pk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">pk</span></span></span></span></span> 中解码出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>，解码过程仅基于固定的编码基数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>。</li>
</ul>
</li>
</ul>
<h3 id="53-噪声向量的生成"><strong>5.3 噪声向量的生成</strong> </h3>
<h4 id="aigis-pke-2"><strong>Aigis-PKE</strong>： </h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><msub><mtext>CBD</mtext><msub><mi>η</mi><mn>1</mn></msub></msub><mo stretchy="false">(</mo><mtext>PRF</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r[i] := \text{CBD}_{\eta_1}(\text{PRF}(r, N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">CBD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">PRF</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">))</span></span></span></span> 生成随机向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></li>
<li>噪声向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e_1[i], e_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>B</mtext><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">\text{B}_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 采样，使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>CBD</mtext><msub><mi>η</mi><mn>2</mn></msub></msub><mo stretchy="false">(</mo><mtext>PRF</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{CBD}_{\eta_2}(\text{PRF}(r, N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">CBD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">PRF</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">))</span></span></span></span></li>
</ul>
<h4 id="kybercpapke-2"><strong>Kyber.CPAPKE</strong>： </h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><msub><mtext>CBD</mtext><msub><mi>η</mi><mn>1</mn></msub></msub><mo stretchy="false">(</mo><mtext>PRF</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r[i] := \text{CBD}_{\eta_1}(\text{PRF}(r, N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">CBD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">PRF</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">))</span></span></span></span> 同样生成随机向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></li>
<li>噪声向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e_1[i], e_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 同样从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>B</mtext><msub><mi>η</mi><mn>2</mn></msub></msub></mrow><annotation encoding="application/x-tex">\text{B}_{\eta_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 采样，使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>CBD</mtext><msub><mi>η</mi><mn>2</mn></msub></msub><mo stretchy="false">(</mo><mtext>PRF</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{CBD}_{\eta_2}(\text{PRF}(r, N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">CBD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">PRF</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">))</span></span></span></span></li>
</ul>
<h4 id="区别-2"><strong>区别</strong>： </h4>
<ul>
<li>噪声生成的核心过程一致，仅在参数（如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>η</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\eta_1, \eta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）的具体实现上存在差异。</li>
</ul>
<hr>
<h3 id="54--密文计算"><strong>5.4  密文计算</strong> </h3>
<h4 id="aigis-pke-3"><strong>Aigis-PKE</strong>： </h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>A</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u := \text{NTT}^{-1}(\hat{A}^T \circ \hat{r}) + e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mtext>NTT</mtext><mo stretchy="false">(</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mn>2</mn></msub><mo>+</mo><mo stretchy="false">⌊</mo><mfrac><mn>2</mn><mi>q</mi></mfrac><mo stretchy="false">⌋</mo><mo>⋅</mo><msub><mtext>Decode</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v := \text{NTT}^{-1}(\text{NTT}(t)^T \circ \hat{r}) + e_2 + \lfloor \frac{2}{q} \rfloor \cdot \text{Decode}_1(\mu)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord">NTT</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.4811em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mclose">)</span></span></span></span></li>
<li>密文编码：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><mo stretchy="false">⌊</mo><mi>u</mi><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1 := \text{Encode}_{d_u}(\lfloor u \rfloor_{q \to 2^{d_u}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0887em;vertical-align:-0.3387em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(⌊</span><span class="mord mathnormal">u</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">u</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mo stretchy="false">(</mo><mo stretchy="false">⌊</mo><mi>v</mi><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_2 := \text{Encode}_{d_v}(\lfloor v \rfloor_{q \to 2^{d_v}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0887em;vertical-align:-0.3387em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(⌊</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
<h4 id="kybercpapke-3"><strong>Kyber.CPAPKE</strong>： </h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>A</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u := \text{NTT}^{-1}(\hat{A}^T \circ \hat{r}) + e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>:</mo><mo>=</mo><msup><mtext>NTT</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>t</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mover accent="true"><mi>r</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mn>2</mn></msub><mo>+</mo><msub><mtext>Decompress</mtext><mi>q</mi></msub><mo stretchy="false">(</mo><msub><mtext>Decode</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v := \text{NTT}^{-1}(\hat{t}^T \circ \hat{r}) + e_2 + \text{Decompress}_q(\text{Decode}_1(m), 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">NTT</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Decompress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li>密文编码：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><msub><mtext>Compress</mtext><mi>q</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>u</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1 := \text{Encode}_{d_u}(\text{Compress}_q(u, d_u))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><msub><mtext>Encode</mtext><msub><mi>d</mi><mi>v</mi></msub></msub><mo stretchy="false">(</mo><msub><mtext>Compress</mtext><mi>q</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_2 := \text{Encode}_{d_v}(\text{Compress}_q(v, d_v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Encode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></li>
</ul>
</li>
</ul>
<h4 id="区别-3"><strong>区别</strong>： </h4>
<ul>
<li>Aigis-PKE 的密文计算中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> 增加了额外项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mfrac><mn>2</mn><mi>q</mi></mfrac><mo stretchy="false">⌋</mo><mo>⋅</mo><msub><mtext>Decode</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\lfloor \frac{2}{q} \rfloor \cdot \text{Decode}_1(\mu)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.4811em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Decode</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mclose">)</span></span></span></span>，而 Kyber.CPAPKE 使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Decompress</mtext><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\text{Decompress}_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0636em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Decompress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span></span></span></span> 函数对明文解码。</li>
<li>Aigis-PKE 的密文编码直接采用舍入操作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>u</mi><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup></mrow></msub></mrow><annotation encoding="application/x-tex">\lfloor u \rfloor_{q \to 2^{d_u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0887em;vertical-align:-0.3387em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">u</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em;"><span style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">u</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span></span></span></span>，而 Kyber.CPAPKE 使用压缩函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Compress</mtext><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\text{Compress}_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0636em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
<hr>
<h3 id="55-密钥压缩和参数表示"><strong>5.5 密钥压缩和参数表示</strong> </h3>
<h4 id="aigis-pke-4"><strong>Aigis-PKE</strong>： </h4>
<ul>
<li>密文的每部分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">c_1, c_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><msub><mi>d</mi><mi>u</mi></msub></msup><mo separator="true">,</mo><msup><mn>2</mn><msub><mi>d</mi><mi>v</mi></msub></msup></mrow><annotation encoding="application/x-tex">2^{d_u}, 2^{d_v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0435em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 为基进行编码，支持动态压缩。</li>
</ul>
<h4 id="kybercpapke-4"><strong>Kyber.CPAPKE</strong>： </h4>
<ul>
<li>密文的压缩基数通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Compress</mtext><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\text{Compress}_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0636em;vertical-align:-0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Compress</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span></span></span></span> 函数确定，较为固定。</li>
</ul>
<h3 id="56-输入输出对比表"><strong>5.6 输入输出对比表</strong> </h3>
<table>
<thead>
<tr>
<th><strong>对比项</strong></th>
<th><strong>Aigis 加密算法</strong></th>
<th><strong>Kyber 加密算法</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>672</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_t \cdot k \cdot n / 8 + n / 8 = 10 \cdot 2 \cdot 256 / 8 + 256 / 8 = 672 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">672</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>12</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>800</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">12 \cdot k \cdot n / 8 + 32 = 12 \cdot 2 \cdot 256 / 8 + 32 = 800 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">800</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
</tr>
<tr>
<td><strong>明文大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>32</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">n / 8 = 256 / 8 = 32 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
<td>固定为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">32 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
</tr>
<tr>
<td><strong>随机数大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>32</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">n / 8 = 256 / 8 = 32 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
<td>固定为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">32 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密文大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><msub><mi>d</mi><mi>v</mi></msub><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>9</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>672</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_u \cdot k \cdot n / 8 + d_v \cdot n / 8 = 9 \cdot 2 \cdot 256 / 8 + 3 \cdot 256 / 8 = 672 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">672</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><msub><mi>d</mi><mi>v</mi></msub><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>768</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_u \cdot k \cdot n / 8 + d_v \cdot n / 8 = 10 \cdot 2 \cdot 256 / 8 + 4 \cdot 256 / 8 = 768 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">768</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></td>
</tr>
</tbody>
</table>
<h2 id="6aigis-pkedecsk-c-和-kybercpapkedecsk-c-解密算法的比较">6.Aigis-pke.Dec(sk, c) 和 Kyber.CPAPKE.Dec(sk, c) 解密算法的比较 </h2>
<h3 id="1-输入参数的格式">1. <strong>输入参数的格式</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li>私钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">sk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 的编码格式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">B\lceil \log_2 q \rceil \cdot k \cdot n / 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span></span></span></span>。</li>
<li>密文 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 的格式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>d</mi><mi>u</mi><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>d</mi><mi>v</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">Bdu \cdot k \cdot n / 8 + dv \cdot n / 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span></span></span></span>。</li>
</ul>
</li>
<li>
<p><strong>Kyber</strong>:</p>
<ul>
<li>私钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">sk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 的编码格式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">B12 \cdot k \cdot n / 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span></span></span></span>。</li>
<li>密文 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 的格式与 Aigis-pke 相同，为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>d</mi><mi>u</mi><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>d</mi><mi>v</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">Bdu \cdot k \cdot n / 8 + dv \cdot n / 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span></span></span></span>。</li>
</ul>
</li>
</ul>
<h3 id="2-密文向量的处理方式">2. <strong>密文向量的处理方式</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><msub><mi>e</mi><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><msub><mo stretchy="false">⌋</mo><mrow><msup><mn>2</mn><mrow><mi>d</mi><mi>u</mi></mrow></msup><mo>→</mo><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">⌈Decode_{d_u}(c)⌋_{2^{du}→q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0887em;vertical-align:-0.3387em;"></span><span class="mopen">⌈</span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4974em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3387em;"><span></span></span></span></span></span></span></span></span></span>  对密文进行处理，直接量化到模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的范围。</li>
<li>同理，对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> 也采用类似的解码方式。</li>
</ul>
</li>
<li>
<p><strong>Kyber</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>s</mi><msub><mi>s</mi><mi>q</mi></msub><mo stretchy="false">(</mo><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><msub><mi>e</mi><msub><mi>d</mi><mi>u</mi></msub></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Decompress_q(Decode_{d_u}(c), du)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">res</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> 对密文向量进行解压缩，将其从较小的编码范围恢复到模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的范围。</li>
<li>同样对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> 也采用解压缩处理。</li>
</ul>
</li>
</ul>
<p><strong>区别</strong>：Aigis-pke 使用的是直接解码，而 Kyber 还引入了解压缩步骤，是因为 Kyber 的密文在加密时使用了压缩机制，从而需要在解密时进行解压。</p>
<h3 id="3-私钥的解码方式">3. <strong>私钥的解码方式</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo stretchy="false">⌈</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo stretchy="false">(</mo><mi>s</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Decode⌈log_2 q⌉(sk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mopen">⌈</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>对私钥进行解码，提取数论变换（NTT）域的向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>s</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
<li>
<p><strong>Kyber</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><msub><mi>e</mi><mn>12</mn></msub><mo stretchy="false">(</mo><mi>s</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Decode_{12}(sk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Deco</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> 对私钥进行解码，提取数论变换（NTT）域的向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>s</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
</ul>
<p><strong>区别</strong>：Aigis-pke 中私钥的编码是基于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \log_2 q \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span></span></span></span>，而 Kyber 中私钥的编码固定为 12 比特。</p>
<h3 id="4-消息恢复的过程">4. <strong>消息恢复的过程</strong> </h3>
<ul>
<li>
<p><strong>Aigis-pke</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mtext>Encode1</mtext><mo stretchy="false">(</mo><mo stretchy="false">⌊</mo><mi>v</mi><mo>−</mo><mi>N</mi><mi>T</mi><msup><mi>T</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mi>N</mi><mi>T</mi><mi>T</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mo stretchy="false">⌋</mo><mrow><mi>q</mi><mo>→</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu = \text{Encode1}(\lfloor v - NTT^{-1}(\hat{s}^T \circ NTT(u)) \rfloor_{q \to 2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Encode1</span></span><span class="mopen">(⌊</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NTT</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">))</span><span class="mclose"><span class="mclose">⌋</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">→</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 来恢复消息。</li>
<li>直接将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>−</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mi>u</mi></mrow><annotation encoding="application/x-tex">v - \hat{s}^T u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span></span></span></span> 的结果量化到二进制范围。</li>
</ul>
</li>
<li>
<p><strong>Kyber</strong>:</p>
<ul>
<li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mtext>Encode1</mtext><mo stretchy="false">(</mo><mtext>Compressq</mtext><mo stretchy="false">(</mo><mi>v</mi><mo>−</mo><mi>N</mi><mi>T</mi><msup><mi>T</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mo>∘</mo><mi>N</mi><mi>T</mi><mi>T</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m = \text{Encode1}(\text{Compressq}(v − NTT^{-1}(\hat{s}^T \circ NTT(u)), 1))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Encode1</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Compressq</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NTT</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">))</span></span></span></span> 来恢复消息。</li>
<li>Kyber 中先对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>−</mo><msup><mover accent="true"><mi>s</mi><mo>^</mo></mover><mi>T</mi></msup><mi>u</mi></mrow><annotation encoding="application/x-tex">v - \hat{s}^T u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">s</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span></span></span></span> 的结果进行压缩<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>s</mi><msub><mi>s</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">Compress_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">res</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> ，然后量化到二进制范围。</li>
</ul>
</li>
</ul>
<p><strong>区别</strong>：Kyber 在消息恢复时引入了压缩步骤，而 Aigis-pke 则没有。</p>
<h3 id="总结表格"><strong>总结表格</strong> </h3>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-pke</strong></th>
<th><strong>Kyber</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>私钥格式</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>832</mn></msup></mrow><annotation encoding="application/x-tex">B^{\lceil \log_2 q \rceil \cdot k \cdot n / 8 }=B^{832}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">832</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>768</mn></msup></mrow><annotation encoding="application/x-tex">B^{12 \cdot k \cdot n / 8 }=B^{768}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">768</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密文格式</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>d</mi><mi>v</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>672</mn></msup></mrow><annotation encoding="application/x-tex">B^{d_u \cdot k \cdot n / 8 + dv \cdot n / 8 }=B^{672}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">672</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>d</mi><mi>v</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>768</mn></msup></mrow><annotation encoding="application/x-tex">B^{d_u \cdot k \cdot n / 8 + dv \cdot n / 8 }=B^{768}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">768</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密文向量处理</strong></td>
<td>直接解码到模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的范围</td>
<td>先解压缩后恢复到模 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> 的范围</td>
</tr>
<tr>
<td><strong>私钥解码</strong></td>
<td>基于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>=</mo><mn>13</mn></mrow><annotation encoding="application/x-tex">\lceil \log_2 q \rceil =13</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">13</span></span></span></span> 的解码</td>
<td>基于固定 12 比特的解码</td>
</tr>
<tr>
<td><strong>消息恢复</strong></td>
<td>直接量化到二进制范围</td>
<td>先压缩后再量化到二进制范围</td>
</tr>
</tbody>
</table>
<h2 id="7aigis-enckeygen-和-kyberccakemkeygen-密钥生成算法的比较">7.Aigis-enc.KeyGen() 和 Kyber.CCAKEM.KeyGen() 密钥生成算法的比较 </h2>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-enc.KeyGen()</strong></th>
<th><strong>Kyber.CCAKEM.KeyGen()</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mrow><mi>d</mi><mi>t</mi></mrow><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>672</mn></msup></mrow><annotation encoding="application/x-tex">B^{{dt} \cdot k \cdot n / 8 + n / 8 } = B^{672}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">672</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>800</mn></msup></mrow><annotation encoding="application/x-tex">B^{{12} \cdot k \cdot n / 8 + 32}  =B^{800}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">12</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>私钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>+</mo><msub><mi>d</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>1568</mn></msup></mrow><annotation encoding="application/x-tex">B^{(\lceil \log_2 q \rceil + d_t) \cdot k \cdot n / 8 + 3n / 8}= B^{1568}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">3</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1568</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>24</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>1632</mn></msup></mrow><annotation encoding="application/x-tex">B^{{24} \cdot k \cdot n / 8 + 96} = B^{1632 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">24</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">96</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1632</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>随机数大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">n / 8 =32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span></td>
<td>32 字节</td>
</tr>
<tr>
<td><strong>底层 PKE 算法</strong></td>
<td><strong>Aigis-pke.KeyGen()</strong></td>
<td><strong>Kyber.CPAPKE.KeyGen()</strong></td>
</tr>
</tbody>
</table>
<h2 id="8aigis-encencapspk和-kyberccakemencpk密钥封装算法的比较">8.Aigis-enc.Encaps(pk)和 Kyber.CCAKEM.Enc(pk)密钥封装算法的比较 </h2>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-enc.Encaps</strong></th>
<th><strong>Kyber.CCAKEM.Enc</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mrow><mi>d</mi><mi>t</mi></mrow><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>672</mn></msup></mrow><annotation encoding="application/x-tex">B^{{dt} \cdot k \cdot n / 8 + n / 8 }    = B^{672}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">672</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>800</mn></msup></mrow><annotation encoding="application/x-tex">B^{{12} \cdot k \cdot n / 8 + 32}  =B^{800}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">12</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>∈</mo><msup><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K \in B^{n/8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>∈</mo><msup><mi>B</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">K \in B^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>随机数生成</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>∈</mo><msup><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">\mu \in B^{n/8} = B^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><msup><mi>B</mi><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">m \in B^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密钥与随机数的生成</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><msup><mi>μ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(\mu' | H(pk))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">))</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>m</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(m | H(pk))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">))</span></span></span></span></td>
</tr>
<tr>
<td><strong>加密内容</strong></td>
<td>加密 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>μ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\mu'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td>加密 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></td>
</tr>
<tr>
<td><strong>底层加密算法</strong></td>
<td><strong>Aigis-pke.Enc</strong></td>
<td><strong>Kyber.CPAPKE.Enc</strong></td>
</tr>
<tr>
<td><strong>密钥派生</strong></td>
<td>哈希函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>K</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(K | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span></td>
<td>专门的密钥派生函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>K</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">KDF(K | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span></td>
</tr>
</tbody>
</table>
<h2 id="aigis-encdecaps-和-kyberccakemdec-解封装算法的比较">Aigis-enc.Decaps 和 Kyber.CCAKEM.Dec 解封装算法的比较 </h2>
<h3 id="总结表格-1">总结表格 </h3>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>Aigis-enc.Decaps</strong></th>
<th><strong>Kyber.CCAKEM.Dec</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>公钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mrow><mi>d</mi><mi>t</mi></mrow><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>672</mn></msup></mrow><annotation encoding="application/x-tex">B^{{dt} \cdot k \cdot n / 8 + n / 8 }    = B^{672}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">672</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>800</mn></msup></mrow><annotation encoding="application/x-tex">B^{{12} \cdot k \cdot n / 8 + 32}  =B^{800}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">12</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>私钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>+</mo><msub><mi>d</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>1568</mn></msup></mrow><annotation encoding="application/x-tex">B^{(\lceil \log_2 q \rceil + d_t) \cdot k \cdot n / 8 + 3n / 8}= B^{1568}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(⌈</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mclose mtight">⌉</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">3</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1568</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mn>24</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn></mrow></msup><mo>=</mo><msup><mi>B</mi><mn>1632</mn></msup></mrow><annotation encoding="application/x-tex">B^{{24} \cdot k \cdot n / 8 + 96} = B^{1632 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">24</span></span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span><span class="mbin mtight">+</span><span class="mord mtight">96</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1632</span></span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><strong>密钥大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>∈</mo><msup><mi>B</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K \in B^{n/8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">/8</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>∈</mo><msup><mi>B</mi><mo>∗</mo></msup><mtext>不固定大小</mtext></mrow><annotation encoding="application/x-tex">K \in B^* 不固定大小</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">不固定大小</span></span></span></span></td>
</tr>
<tr>
<td><strong>随机数大小</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">n / 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span></span></span></span></td>
<td>32 字节</td>
</tr>
<tr>
<td><strong>密钥生成与加密</strong></td>
<td><strong>Aigis-pke.Dec</strong> 和 <strong>Aigis-pke.Enc</strong></td>
<td><strong>Kyber.CPAPKE.Dec</strong> 和 <strong>Kyber.CPAPKE.Enc</strong></td>
</tr>
<tr>
<td><strong>密文验证与密钥派生</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>K</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(K' | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span> 和备用密钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(z | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>K</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">KDF(K_0 | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span> 和备用密钥 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">KDF(z | H(c))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">KD</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">))</span></span></span></span></td>
</tr>
</tbody>
</table>
<h2 id="所有参数集大小">所有参数集大小 </h2>
<p><strong>公钥大小：</strong><br>
Aigis-enc<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>672</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_t \cdot k \cdot n / 8 + n / 8 = 10 \cdot 2 \cdot 256 / 8 + 256 / 8 = 672 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">672</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>9</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>896</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=9 \cdot 3 \cdot 256 / 8 + 256 / 8 = 896 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">896</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>11</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>1472</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=11 \cdot 2 \cdot 512 / 8 + 512 / 8 = 1472\, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1472</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
kyber<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>12</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>800</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">12 \cdot k \cdot n / 8 + 32 = 12 \cdot 2 \cdot 256 / 8 + 32 = 800 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">800</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>12</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>1184</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= 12 \cdot 3 \cdot 256 / 8 + 32 = 1184 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1184</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>12</mn><mo>⋅</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>32</mn><mo>=</mo><mn>1568</mn><mtext> </mtext><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= 12 \cdot 4 \cdot 256 / 8 + 32 = 1568 \, \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1568</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<strong>私钥大小：</strong><br>
Aigis-enc<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>q</mi><mo stretchy="false">⌉</mo><mo>+</mo><msub><mi>d</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mo stretchy="false">(</mo><mn>13</mn><mo>+</mo><mn>10</mn><mo stretchy="false">)</mo><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>1568</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">(\lceil \log_2 q \rceil + d_t) \cdot k \cdot n / 8 + 3n / 8= (13 + 10) \cdot 2 \cdot 256 / 8 + 3 \cdot 256 / 8=1568 \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">13</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">10</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1568</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>13</mn><mo>+</mo><mn>9</mn><mo stretchy="false">)</mo><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>2208</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= (13 + 9) \cdot 3 \cdot 256 / 8 + 3 \cdot 256 / 8=2208\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">13</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">9</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2208</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo stretchy="false">(</mo><mn>14</mn><mo>+</mo><mn>11</mn><mo stretchy="false">)</mo><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>3392</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= (14 + 11) \cdot 2 \cdot 512 / 8 + 3 \cdot 512 / 8=3392 \text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">14</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">11</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">3392</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
kyber<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>24</mn><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn><mo>=</mo><mn>24</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn><mo>=</mo><mn>1632</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">24 \cdot k \cdot n / 8 + 96 = 24\cdot 2 \cdot 256 / 8 + 96=1632 {字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">96</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">96</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1632</span><span class="mord"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>24</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn><mo>=</mo><mn>2400</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= 24\cdot 3 \cdot 256 / 8 + 96=2400 {字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">96</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2400</span><span class="mord"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>24</mn><mo>⋅</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>96</mn><mo>=</mo><mn>3168</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">= 24\cdot 4 \cdot 256 / 8 + 96=3168 {字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">24</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">96</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">3168</span><span class="mord"><span class="mord cjk_fallback">字节</span></span></span></span></span></p>
<p><strong>密文格式</strong><br>
Aigis-enc<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mi>d</mi><mi>v</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>9</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>672</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_u \cdot k \cdot n / 8 + dv \cdot n / 8 =9 \cdot 2 \cdot 256 / 8 + 3 \cdot 256 / 8=672\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">672</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>9</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>992</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=9 \cdot 3 \cdot 256 / 8 + 4 \cdot 256 / 8=992\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">992</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>4</mn><mo>⋅</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>1536</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=10 \cdot 2 \cdot 512 / 8 + 4 \cdot 512 / 8=1536\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">512/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1536</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></p>
<p>kyber<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>u</mi></msub><mo>⋅</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><msub><mi>d</mi><mi>v</mi></msub><mo>⋅</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>768</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">d_u \cdot k \cdot n / 8 + d_v \cdot n / 8 =10 \cdot 2 \cdot 256 / 8 + 4 \cdot 256 / 8 =768\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">768</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>10</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>1088</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=10 \cdot 3 \cdot 256 / 8 + 4 \cdot 256 / 8 =1088\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1088</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>11</mn><mo>⋅</mo><mn>4</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mn>5</mn><mo>⋅</mo><mn>256</mn><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mn>1568</mn><mtext>字节</mtext></mrow><annotation encoding="application/x-tex">=11 \cdot 4 \cdot 256 / 8 + 5 \cdot 256 / 8 =1568\text{字节}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">256/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1568</span><span class="mord text"><span class="mord cjk_fallback">字节</span></span></span></span></span></p>

      </div>
      
      
    
    
    
    
    
    
  </body></html>